(function(N,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["exports","vue","pinia"],e):(N=typeof globalThis<"u"?globalThis:N||self,e(N.RestifyAi={},N.Vue,N.Pinia))})(this,function(N,e,Qe){"use strict";var Aa=Object.defineProperty;var Na=(N,e,Qe)=>e in N?Aa(N,e,{enumerable:!0,configurable:!0,writable:!0,value:Qe}):N[e]=Qe;var F=(N,e,Qe)=>Na(N,typeof e!="symbol"?e+"":e,Qe);let Pe=null;const br=e.ref(null),Mt={title:"AI Assistant",aiName:"AI Assistant",you:"You",newChat:"New chat",placeholder:"Ask me anything...",inputPlaceholder:"Ask me anything...",supportPlaceholder:"Describe your support request...",loadingText:"Thinking...",analyzingText:"Analyzing...",craftingText:"Crafting response...",quotaRemaining:"{count} questions remaining",noQuota:"No AI credit available",contactSupport:"Contact Support",close:"Close",minimize:"Minimize",fullscreen:"Fullscreen",exitFullscreen:"Exit fullscreen",copyToClipboard:"Copy to clipboard",copied:"Copied!",showMore:"Show more",showLess:"Show less",retry:"Retry",attachFiles:"Attach files",emptyStateTitle:"How can I help you today?",emptyStateDescription:"Ask me anything or choose a suggestion below",keyboardShortcutHint:"Press âŒ˜G to toggle",sendMessage:"Send message",attachFile:"Attach file",closeConfirmTitle:"Close conversation?",closeConfirmMessage:"This will clear your chat history. Are you sure you want to close?",confirmClose:"Close & Clear",cancel:"Cancel",toggleSupportMode:"Toggle support mode",exitSupportMode:"Exit support mode",setupWelcomeTitle:"Welcome to AI Assistant",setupWelcomeDescription:"Let's get you set up to start using AI features.",setupApiKeyTitle:"API Key Configuration",setupApiKeyDescription:"Enter your API key to test the connection",setupTestingTitle:"Testing Connection...",setupBackendTitle:"Backend Configuration",setupBackendDescription:"Configure your backend endpoint",setupCompleteTitle:"Setup Complete!"};function an(o){Pe=o,br.value=o}function j(){return Pe}function wr(){if(!Pe)throw new Error("[@doderasoftware/restify-ai] Plugin not initialized. Make sure to call app.use(RestifyAiPlugin, config) before using the components.");return Pe}function Rt(){return Pe!==null}function te(o,t){const n=Pe,r=(n==null?void 0:n.labels)||{},s=n==null?void 0:n.translate;if(s){const i=s(o,t);if(i!==o)return i}let a=r[o]||Mt[o];return t&&Object.entries(t).forEach(([i,c])=>{a=a.replace(`{${i}}`,String(c))}),a}function ln(o){return{chatHistoryLimit:15,maxAttachments:5,maxFileSize:10485760,acceptedFileTypes:"image/*,.pdf,.txt,.doc,.docx,.xls,.xlsx,.csv",chatHistoryKey:"restify_ai_chat_history",drawerStateKey:"restify_ai_drawer_open",keyboardShortcut:"cmd+g",enableSupportMode:!1}[o]}function Fe(o){const t=Pe;return t?t[o]??ln(o):ln(o)}const Bt={Assistant:"assistant",User:"user",System:"system"};async function Er(o,t){const n=o.getReader();let r;for(;!(r=await n.read()).done;)t(r.value)}function Cr(o){let t,n,r,s=!1;return function(i){t===void 0?(t=i,n=0,r=-1):t=Sr(t,i);const c=t.length;let u=0;for(;n<c;){s&&(t[n]===10&&(u=++n),s=!1);let p=-1;for(;n<c&&p===-1;++n)switch(t[n]){case 58:r===-1&&(r=n-u);break;case 13:s=!0;case 10:p=n;break}if(p===-1)break;o(t.subarray(u,p),r),u=n,r=-1}u===c?t=void 0:u!==0&&(t=t.subarray(u),n-=u)}}function Tr(o,t,n){let r=cn();const s=new TextDecoder;return function(i,c){if(i.length===0)n==null||n(r),r=cn();else if(c>0){const u=s.decode(i.subarray(0,c)),p=c+(i[c+1]===32?2:1),f=s.decode(i.subarray(p));switch(u){case"data":r.data=r.data?r.data+`
`+f:f;break;case"event":r.event=f;break;case"id":o(r.id=f);break;case"retry":const k=parseInt(f,10);isNaN(k)||t(r.retry=k);break}}}}function Sr(o,t){const n=new Uint8Array(o.length+t.length);return n.set(o),n.set(t,o.length),n}function cn(){return{data:"",event:"",id:"",retry:void 0}}var Ar=function(o,t){var n={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&t.indexOf(r)<0&&(n[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(o);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(o,r[s])&&(n[r[s]]=o[r[s]]);return n};const Lt="text/event-stream",Nr=1e3,un="last-event-id";function _r(o,t){var{signal:n,headers:r,onopen:s,onmessage:a,onclose:i,onerror:c,openWhenHidden:u,fetch:p}=t,f=Ar(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((k,y)=>{const b=Object.assign({},r);b.accept||(b.accept=Lt);let x;function M(){x.abort(),document.hidden||O()}u||document.addEventListener("visibilitychange",M);let h=Nr,E=0;function _(){document.removeEventListener("visibilitychange",M),window.clearTimeout(E),x.abort()}n==null||n.addEventListener("abort",()=>{_(),k()});const T=p??window.fetch,S=s??Mr;async function O(){var W;x=new AbortController;try{const Z=await T(o,Object.assign(Object.assign({},f),{headers:b,signal:x.signal}));await S(Z),await Er(Z.body,Cr(Tr(ee=>{ee?b[un]=ee:delete b[un]},ee=>{h=ee},a))),i==null||i(),_(),k()}catch(Z){if(!x.signal.aborted)try{const ee=(W=c==null?void 0:c(Z))!==null&&W!==void 0?W:h;window.clearTimeout(E),E=window.setTimeout(O,ee)}catch(ee){_(),y(ee)}}}O()})}function Mr(o){const t=o.headers.get("content-type");if(!(t!=null&&t.startsWith(Lt)))throw new Error(`Expected content-type to be ${Lt}, Actual: ${t}`)}let tt=new AbortController;function mt(o){const t=j(),n=(t==null?void 0:t.baseUrl)||"";if(!n||o.startsWith("http://")||o.startsWith("https://"))return o;const r=n.endsWith("/")?n.slice(0,-1):n,s=o.startsWith("/")?o:`/${o}`;return`${r}${s}`}function Rr(o){var t,n,r;try{if(o==="[DONE]")return"[DONE]";const s=JSON.parse(o);return((r=(n=(t=s==null?void 0:s.choices)==null?void 0:t[0])==null?void 0:n.delta)==null?void 0:r.content)||""}catch{return null}}function Br(o){return new Promise(t=>setTimeout(t,o))}function He(o){const t=j();return o==="chatHistory"?(t==null?void 0:t.chatHistoryKey)||"restify_ai_chat_history":o==="setupComplete"?"restify_ai_setup_complete":(t==null?void 0:t.drawerStateKey)||"restify_ai_drawer_open"}function Dt(o){try{sessionStorage.setItem(He("chatHistory"),JSON.stringify(o))}catch(t){console.warn("[RestifyAi] Failed to save chat history:",t)}}function Lr(){try{const o=sessionStorage.getItem(He("chatHistory"));if(o)return JSON.parse(o)}catch(o){console.warn("[RestifyAi] Failed to load chat history:",o)}return[]}function Dr(){try{sessionStorage.removeItem(He("chatHistory"))}catch(o){console.warn("[RestifyAi] Failed to clear chat history:",o)}}function It(o){try{localStorage.setItem(He("drawerState"),JSON.stringify(o))}catch(t){console.warn("[RestifyAi] Failed to save drawer state:",t)}}function Ir(){try{const o=localStorage.getItem(He("drawerState"));if(o!==null)return JSON.parse(o)}catch(o){console.warn("[RestifyAi] Failed to load drawer state:",o)}return!1}function zr(){try{return localStorage.getItem(He("setupComplete"))==="true"}catch{return!1}}function dn(){try{localStorage.setItem(He("setupComplete"),"true")}catch(o){console.warn("[RestifyAi] Failed to mark setup complete:",o)}}function Vr(o){const t={};return o.forEach(n=>{var r;(r=n.attachments)==null||r.forEach(s=>{s!=null&&s.id&&(t[s.id]=s)})}),t}function pn(){return{isActive:!1,currentStep:"welcome",testApiKey:null,connectionStatus:"idle",backendConfigured:!1,lastError:null}}const Ue=Qe.defineStore("restifyAiStore",{state:()=>{const o=Lr();return{chatHistoryLimit:Fe("chatHistoryLimit")||15,chatHistory:o,uploadedFiles:Vr(o),loading:!1,showChat:Ir(),isFullscreen:!1,sending:!1,pageContext:null,quota:{limit:100,used:0,remaining:100},error:{message:null,failedQuestion:null,failedAttachments:null,timestamp:null,quotaExceeded:!1},supportRequestMode:!1,setupState:!Rt()&&!zr()?{...pn(),isActive:!0}:pn()}},getters:{hasMessages:o=>o.chatHistory.length>0,isInSetupMode:o=>o.setupState.isActive,canChat:o=>!o.setupState.isActive||o.setupState.connectionStatus==="connected"},actions:{async scrollToBottom(){await e.nextTick();const o=document.getElementById("rai-chat-bottom");o&&o.scrollIntoView({behavior:"smooth"})},parseStreamContent(o){const t=j(),n=t==null?void 0:t.parseStreamContent;return n?n(o.data):Rr(o.data)},async askQuestion(o,t=[],n=[],r=!1){const s=j();if(!s)return console.warn("[RestifyAi] Cannot ask question - plugin not configured"),!1;let a="",i=!1;const c=s.retry||{},u=c.maxRetries??0,p=c.retryDelay??1e3;let f=0;const k=t.map(b=>({id:b.id,name:b.name,url:b.url,type:b.type,size:b.size,extractedText:b.extractedText})),y=async()=>{var b,x,M,h;try{this.chatHistory.push({id:crypto.randomUUID(),role:Bt.User,message:o,loading:!1,attachments:k,mentions:n,timestamp:Date.now()}),k.forEach(R=>this.registerUploadedFile(R)),Dt(this.chatHistory),this.chatHistory.length>=this.chatHistoryLimit&&((b=s.onError)==null||b.call(s,new Error("Chat history limit reached")));const E=this.chatHistory.map(R=>({role:R.role,message:R.message,attachments:R.attachments??[]})),_={},T=R=>{R!=null&&R.id&&(_[R.id]={extracted_text:R.extractedText||"",file_name:R.name,mime_type:R.type||"",...R.size?{file_size:R.size}:{},...R.url?{file_url:R.url}:{}})};Object.values(this.uploadedFiles).forEach(T),this.chatHistory.forEach(R=>{var G;(G=R.attachments)==null||G.forEach(T)}),k.forEach(T);const S=Object.values(_),O=this.chatHistory.length;this.chatHistory.push({id:crypto.randomUUID(),role:Bt.Assistant,message:"",loading:!0,timestamp:Date.now()}),Dt(this.chatHistory),this.sending=!0,tt=new AbortController;const W=await s.getAuthToken();let ee={"Content-Type":"application/json",Accept:"application/vnd.api+json",...s.getCustomHeaders?await s.getCustomHeaders():{}};this.setupState.isActive&&this.setupState.testApiKey?ee["X-Test-Api-Key"]=this.setupState.testApiKey:W&&(ee.Authorization=`Bearer ${W}`);let xe={question:o,history:E,stream:!0,...S.length>0&&{files:S},...n.length>0&&{mentions:n},...this.supportRequestMode&&{contact_support:!0}};s.beforeSend&&(xe=await s.beforeSend(xe)),s.buildRequest&&(xe=await s.buildRequest(xe)),(x=s.onMessageSent)==null||x.call(s,this.chatHistory[O-1]);const Ie=mt(s.endpoints.ask);let q={method:"POST",body:JSON.stringify(xe),headers:ee};return s.requestInterceptor&&(q=await s.requestInterceptor(Ie,q)),(M=s.onStreamStart)==null||M.call(s),await _r(Ie,{method:"POST",body:JSON.stringify(xe),signal:tt.signal,headers:q.headers,openWhenHidden:!0,async onopen(R){if(!R.ok){if(R.status===429){const G=Ue();throw G.error={message:te("noQuota"),failedQuestion:o,failedAttachments:k,timestamp:Date.now(),quotaExceeded:!0},await G.fetchQuota(),new Error("Quota exceeded")}throw new Error(`Failed to connect: ${R.status}`)}},onmessage:async R=>{var ze,Ne,Te;const G=this.parseStreamContent(R);if(!G)return;this.chatHistory[O].loading=!1;const de={content:G,done:G==="[DONE]",raw:R.data};(ze=s.onStreamChunk)==null||ze.call(s,de),a?G==="[DONE]"?(this.chatHistory[O].streaming=!1,Dt(this.chatHistory),(Ne=s.onStreamEnd)==null||Ne.call(s,a),this.quota.remaining>0&&!this.supportRequestMode&&(this.quota.remaining--,this.quota.used++,this.quota.remaining===0&&s.enableSupportMode!==!1&&(this.supportRequestMode=!0)),this.supportRequestMode&&this.quota.remaining>0&&(this.supportRequestMode=!1),s.afterResponse&&await s.afterResponse(this.chatHistory[O]),(Te=s.onResponseReceived)==null||Te.call(s,this.chatHistory[O])):(a+=G,this.chatHistory[O].message=a):(a=G,this.chatHistory[O].message=a,this.chatHistory[O].streaming=!0),await this.scrollToBottom()},onerror(R){throw i=!0,R}}),!0}catch(E){i=!0;const _=this.chatHistory.length-1;return this.chatHistory.splice(_,1),E.name==="AbortError"?!0:f<u&&(c.shouldRetry?c.shouldRetry(E,f):!0)?(f++,await Br(p*f),y()):(this.error={message:E.message||"Network error occurred. Please try again.",failedQuestion:o,failedAttachments:k,timestamp:Date.now()},(h=s.onError)==null||h.call(s,E),!1)}finally{this.sending=!1}};return y()},cancelRequest(){tt==null||tt.abort(),this.chatHistory=this.chatHistory.map(o=>({...o,streaming:!1,loading:!1})),this.sending=!1},clearChatHistory(){var t;const o=j();this.chatHistory=[],this.sending=!1,this.uploadedFiles={},this.quota.remaining>0&&(this.supportRequestMode=!1),Dr(),(t=o==null?void 0:o.onNewChat)==null||t.call(o)},async retry(){if(!this.error.failedQuestion)return!1;const o=this.error.failedQuestion,t=this.error.failedAttachments||[];return this.clearError(),await this.askQuestion(o,t)},clearError(){this.error={message:null,failedQuestion:null,failedAttachments:null,timestamp:null,quotaExceeded:!1}},toggleSupportMode(){this.supportRequestMode=!this.supportRequestMode},async fetchQuota(){var t,n;const o=j();if((t=o==null?void 0:o.endpoints)!=null&&t.quota)try{const r=await o.getAuthToken(),s=o.getCustomHeaders?await o.getCustomHeaders():{},a=mt(o.endpoints.quota),i=await fetch(a,{headers:{Accept:"application/json",...r?{Authorization:`Bearer ${r}`}:{},...s}});if(i.ok){const c=await i.json();this.quota={limit:c.limit??this.quota.limit,used:c.used??this.quota.used,remaining:c.remaining??this.quota.remaining},this.quota.remaining===0&&o.enableSupportMode!==!1&&(this.supportRequestMode=!0),(n=o.onQuotaFetched)==null||n.call(o,this.quota)}}catch(r){console.error("[RestifyAi] Failed to fetch quota:",r)}},async uploadFile(o){var s,a,i,c,u;const t=j();if(!((s=t==null?void 0:t.endpoints)!=null&&s.uploadFile))return console.warn("[RestifyAi] No uploadFile endpoint configured"),null;const r={id:crypto.randomUUID(),name:o.name,type:o.type,size:o.size,uploading:!0,progress:0};(a=t.onFileUploadStart)==null||a.call(t,r);try{const p=await t.getAuthToken(),f=t.getCustomHeaders?await t.getCustomHeaders():{},k=mt(t.endpoints.uploadFile),y=new FormData;y.append("file",o);const b=await new Promise((x,M)=>{const h=new XMLHttpRequest;h.upload.addEventListener("progress",E=>{var _;if(E.lengthComputable){const T=Math.round(E.loaded/E.total*100);r.progress=T,(_=t.onFileUploadProgress)==null||_.call(t,r,T)}}),h.addEventListener("load",()=>{var E,_;if(h.status>=200&&h.status<300)try{const T=JSON.parse(h.responseText),S={...r,url:T.url||((E=T.data)==null?void 0:E.url),extractedText:T.extracted_text||((_=T.data)==null?void 0:_.extracted_text),uploading:!1,progress:100};x(S)}catch{M(new Error("Failed to parse upload response"))}else M(new Error(`Upload failed: ${h.status}`))}),h.addEventListener("error",()=>{M(new Error("Upload failed"))}),h.open("POST",k),p&&h.setRequestHeader("Authorization",`Bearer ${p}`),Object.entries(f).forEach(([E,_])=>{h.setRequestHeader(E,_)}),h.send(y)});return(i=t.onFileUploadComplete)==null||i.call(t,b),b}catch(p){const f={...r,uploading:!1};return(c=t.onFileUploadError)==null||c.call(t,f,p),(u=t.onError)==null||u.call(t,p),null}},setPageContext(o){this.pageContext=o},toggleDrawer(){var o,t;this.showChat=!this.showChat,It(this.showChat),(t=(o=j())==null?void 0:o.onDrawerToggle)==null||t.call(o,this.showChat)},openDrawer(){var o,t;this.showChat=!0,It(!0),(t=(o=j())==null?void 0:o.onDrawerToggle)==null||t.call(o,!0)},closeDrawer(){var o,t;this.showChat=!1,It(!1),(t=(o=j())==null?void 0:o.onDrawerToggle)==null||t.call(o,!1)},startSupportRequest(){this.supportRequestMode=!0},cancelSupportRequest(){this.quota.remaining>0&&(this.supportRequestMode=!1)},registerUploadedFile(o){o!=null&&o.id&&(this.uploadedFiles[o.id]={...o})},startSetupMode(){this.setupState={isActive:!0,currentStep:"welcome",testApiKey:null,connectionStatus:"idle",backendConfigured:!1,lastError:null}},setSetupStep(o){this.setupState.currentStep=o},setTestApiKey(o){this.setupState.testApiKey=o},async testConnection(){this.setupState.connectionStatus="testing",this.setupState.lastError=null;const o=j();if(!o)return this.setupState.connectionStatus="failed",this.setupState.lastError="Plugin not configured",!1;try{const t={"Content-Type":"application/json",Accept:"application/json"};this.setupState.testApiKey&&(t["X-Test-Api-Key"]=this.setupState.testApiKey);const n=o.endpoints.quota||o.endpoints.ask,r=mt(n),s=await fetch(r,{method:o.endpoints.quota?"GET":"POST",headers:t,...o.endpoints.quota?{}:{body:JSON.stringify({question:"test",stream:!1})}});return s.ok?(this.setupState.connectionStatus="connected",this.setupState.backendConfigured=!0,!0):(this.setupState.connectionStatus="failed",this.setupState.lastError=`Connection failed: ${s.status} ${s.statusText}`,!1)}catch(t){return this.setupState.connectionStatus="failed",this.setupState.lastError=t.message||"Connection failed",!1}},completeSetup(){var o,t;this.setupState.isActive=!1,this.setupState.currentStep="complete",dn(),(t=(o=j())==null?void 0:o.onSetupComplete)==null||t.call(o)},skipSetup(){this.setupState.isActive=!1,dn()}}});function fn(o){const t=/@\[([^\]]+)\]\(([^)]+)\)/g,n=[];let r=o,s;for(;(s=t.exec(o))!==null;){const[a,i,c]=s,[u,p]=c.includes(":")?c.split(":"):["default",c];n.push({id:p,name:i,type:u}),r=r.replace(a,i)}return{cleanText:r,mentions:n}}function Or(o){const{cleanText:t}=fn(o);return t}function hn(o){return o.replace(/@([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/g,'<span class="rai-mention">@$1</span>')}function mn(o,t){const r=o.substring(0,t).match(/@(\w*)$/);return r?{inMention:!0,query:r[1],startPos:t-r[0].length}:{inMention:!1,query:"",startPos:-1}}function zt(o,t){var n,r;return t!=null&&t.getDisplayName?t.getDisplayName(o):o.name||o.title||((n=o.attributes)==null?void 0:n.name)||((r=o.attributes)==null?void 0:r.title)||"Unknown"}function gn(o,t){var n,r;return t!=null&&t.getSubtitle?t.getSubtitle(o):((n=o.attributes)==null?void 0:n.email)||((r=o.attributes)==null?void 0:r.description)||null}function $r(o,t){return t!=null&&t.buildMentionText?t.buildMentionText(o):`@[${zt(o,t)}](${o.type}:${o.id})`}function yn(o){var n;const t=j();return(n=t==null?void 0:t.mentionProviders)==null?void 0:n.find(r=>r.type===o)}function kn(o){const t=j(),n=(t==null?void 0:t.mentionProviders)||[];return o?n.filter(r=>r.routes?r.routes.some(s=>s.endsWith("*")?o.startsWith(s.slice(0,-1)):o===s||o.startsWith(s+"/")):!0):n}function xn(o){return o.map(t=>({type:t.type,id:t.id,name:t.name}))}function bn(o){return o.reduce((t,n)=>{const r=n.type||"default";return t[r]||(t[r]=[]),t[r].push(n),t},{})}function Pr(){return{extractMentions:fn,parseAndCleanMessage:Or,renderMentionsInHtml:hn,detectMentionContext:mn,getMentionDisplayName:zt,getMentionSubtitle:gn,buildMentionText:$r,getMentionProvider:yn,getActiveMentionProviders:kn,formatMentionsForApi:xn,groupMentionsByType:bn}}function Vt(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let qe=Vt();function wn(o){qe=o}const En=/[&<>"']/,Fr=new RegExp(En.source,"g"),Cn=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Hr=new RegExp(Cn.source,"g"),Ur={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Tn=o=>Ur[o];function he(o,t){if(t){if(En.test(o))return o.replace(Fr,Tn)}else if(Cn.test(o))return o.replace(Hr,Tn);return o}const qr=/(^|[^\[])\^/g;function $(o,t){let n=typeof o=="string"?o:o.source;t=t||"";const r={replace:(s,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(qr,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,t)};return r}function Sn(o){try{o=encodeURI(o).replace(/%25/g,"%")}catch{return null}return o}const nt={exec:()=>null};function An(o,t){const n=o.replace(/\|/g,(a,i,c)=>{let u=!1,p=i;for(;--p>=0&&c[p]==="\\";)u=!u;return u?"|":" |"}),r=n.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function rt(o,t,n){const r=o.length;if(r===0)return"";let s=0;for(;s<r&&o.charAt(r-s-1)===t;)s++;return o.slice(0,r-s)}function vr(o,t){if(o.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<o.length;r++)if(o[r]==="\\")r++;else if(o[r]===t[0])n++;else if(o[r]===t[1]&&(n--,n<0))return r;return-1}function Nn(o,t,n,r){const s=t.href,a=t.title?he(t.title):null,i=o[1].replace(/\\([\[\]])/g,"$1");if(o[0].charAt(0)!=="!"){r.state.inLink=!0;const c={type:"link",raw:n,href:s,title:a,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,c}return{type:"image",raw:n,href:s,title:a,text:he(i)}}function jr(o,t){const n=o.match(/^(\s+)(?:```)/);if(n===null)return t;const r=n[1];return t.split(`
`).map(s=>{const a=s.match(/^\s+/);if(a===null)return s;const[i]=a;return i.length>=r.length?s.slice(r.length):s}).join(`
`)}class gt{constructor(t){F(this,"options");F(this,"rules");F(this,"lexer");this.options=t||qe}space(t){const n=this.rules.block.newline.exec(t);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(t){const n=this.rules.block.code.exec(t);if(n){const r=n[0].replace(/^(?: {1,4}| {0,3}\t)/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:rt(r,`
`)}}}fences(t){const n=this.rules.block.fences.exec(t);if(n){const r=n[0],s=jr(r,n[3]||"");return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:s}}}heading(t){const n=this.rules.block.heading.exec(t);if(n){let r=n[2].trim();if(/#$/.test(r)){const s=rt(r,"#");(this.options.pedantic||!s||/ $/.test(s))&&(r=s.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){const n=this.rules.block.hr.exec(t);if(n)return{type:"hr",raw:rt(n[0],`
`)}}blockquote(t){const n=this.rules.block.blockquote.exec(t);if(n){let r=rt(n[0],`
`).split(`
`),s="",a="";const i=[];for(;r.length>0;){let c=!1;const u=[];let p;for(p=0;p<r.length;p++)if(/^ {0,3}>/.test(r[p]))u.push(r[p]),c=!0;else if(!c)u.push(r[p]);else break;r=r.slice(p);const f=u.join(`
`),k=f.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");s=s?`${s}
${f}`:f,a=a?`${a}
${k}`:k;const y=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(k,i,!0),this.lexer.state.top=y,r.length===0)break;const b=i[i.length-1];if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){const x=b,M=x.raw+`
`+r.join(`
`),h=this.blockquote(M);i[i.length-1]=h,s=s.substring(0,s.length-x.raw.length)+h.raw,a=a.substring(0,a.length-x.text.length)+h.text;break}else if((b==null?void 0:b.type)==="list"){const x=b,M=x.raw+`
`+r.join(`
`),h=this.list(M);i[i.length-1]=h,s=s.substring(0,s.length-b.raw.length)+h.raw,a=a.substring(0,a.length-x.raw.length)+h.raw,r=M.substring(i[i.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:i,text:a}}}list(t){let n=this.rules.block.list.exec(t);if(n){let r=n[1].trim();const s=r.length>1,a={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const i=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let c=!1;for(;t;){let u=!1,p="",f="";if(!(n=i.exec(t))||this.rules.block.hr.test(t))break;p=n[0],t=t.substring(p.length);let k=n[2].split(`
`,1)[0].replace(/^\t+/,E=>" ".repeat(3*E.length)),y=t.split(`
`,1)[0],b=!k.trim(),x=0;if(this.options.pedantic?(x=2,f=k.trimStart()):b?x=n[1].length+1:(x=n[2].search(/[^ ]/),x=x>4?1:x,f=k.slice(x),x+=n[1].length),b&&/^[ \t]*$/.test(y)&&(p+=y+`
`,t=t.substring(y.length+1),u=!0),!u){const E=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),_=new RegExp(`^ {0,${Math.min(3,x-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),T=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:\`\`\`|~~~)`),S=new RegExp(`^ {0,${Math.min(3,x-1)}}#`),O=new RegExp(`^ {0,${Math.min(3,x-1)}}<(?:[a-z].*>|!--)`,"i");for(;t;){const W=t.split(`
`,1)[0];let Z;if(y=W,this.options.pedantic?(y=y.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  "),Z=y):Z=y.replace(/\t/g,"    "),T.test(y)||S.test(y)||O.test(y)||E.test(y)||_.test(y))break;if(Z.search(/[^ ]/)>=x||!y.trim())f+=`
`+Z.slice(x);else{if(b||k.replace(/\t/g,"    ").search(/[^ ]/)>=4||T.test(k)||S.test(k)||_.test(k))break;f+=`
`+y}!b&&!y.trim()&&(b=!0),p+=W+`
`,t=t.substring(W.length+1),k=Z.slice(x)}}a.loose||(c?a.loose=!0:/\n[ \t]*\n[ \t]*$/.test(p)&&(c=!0));let M=null,h;this.options.gfm&&(M=/^\[[ xX]\] /.exec(f),M&&(h=M[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:p,task:!!M,checked:h,loose:!1,text:f,tokens:[]}),a.raw+=p}a.items[a.items.length-1].raw=a.items[a.items.length-1].raw.trimEnd(),a.items[a.items.length-1].text=a.items[a.items.length-1].text.trimEnd(),a.raw=a.raw.trimEnd();for(let u=0;u<a.items.length;u++)if(this.lexer.state.top=!1,a.items[u].tokens=this.lexer.blockTokens(a.items[u].text,[]),!a.loose){const p=a.items[u].tokens.filter(k=>k.type==="space"),f=p.length>0&&p.some(k=>/\n.*\n/.test(k.raw));a.loose=f}if(a.loose)for(let u=0;u<a.items.length;u++)a.items[u].loose=!0;return a}}html(t){const n=this.rules.block.html.exec(t);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(t){const n=this.rules.block.def.exec(t);if(n){const r=n[1].toLowerCase().replace(/\s+/g," "),s=n[2]?n[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:s,title:a}}}table(t){const n=this.rules.block.table.exec(t);if(!n||!/[:|]/.test(n[2]))return;const r=An(n[1]),s=n[2].replace(/^\||\| *$/g,"").split("|"),a=n[3]&&n[3].trim()?n[3].replace(/\n[ \t]*$/,"").split(`
`):[],i={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===s.length){for(const c of s)/^ *-+: *$/.test(c)?i.align.push("right"):/^ *:-+: *$/.test(c)?i.align.push("center"):/^ *:-+ *$/.test(c)?i.align.push("left"):i.align.push(null);for(let c=0;c<r.length;c++)i.header.push({text:r[c],tokens:this.lexer.inline(r[c]),header:!0,align:i.align[c]});for(const c of a)i.rows.push(An(c,i.header.length).map((u,p)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:i.align[p]})));return i}}lheading(t){const n=this.rules.block.lheading.exec(t);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(t){const n=this.rules.block.paragraph.exec(t);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(t){const n=this.rules.block.text.exec(t);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(t){const n=this.rules.inline.escape.exec(t);if(n)return{type:"escape",raw:n[0],text:he(n[1])}}tag(t){const n=this.rules.inline.tag.exec(t);if(n)return!this.lexer.state.inLink&&/^<a /i.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(t){const n=this.rules.inline.link.exec(t);if(n){const r=n[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const i=rt(r.slice(0,-1),"\\");if((r.length-i.length)%2===0)return}else{const i=vr(n[2],"()");if(i>-1){const u=(n[0].indexOf("!")===0?5:4)+n[1].length+i;n[2]=n[2].substring(0,i),n[0]=n[0].substring(0,u).trim(),n[3]=""}}let s=n[2],a="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);i&&(s=i[1],a=i[3])}else a=n[3]?n[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(r)?s=s.slice(1):s=s.slice(1,-1)),Nn(n,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer)}}reflink(t,n){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){const s=(r[2]||r[1]).replace(/\s+/g," "),a=n[s.toLowerCase()];if(!a){const i=r[0].charAt(0);return{type:"text",raw:i,text:i}}return Nn(r,a,r[0],this.lexer)}}emStrong(t,n,r=""){let s=this.rules.inline.emStrongLDelim.exec(t);if(!s||s[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const i=[...s[0]].length-1;let c,u,p=i,f=0;const k=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(k.lastIndex=0,n=n.slice(-1*t.length+i);(s=k.exec(n))!=null;){if(c=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!c)continue;if(u=[...c].length,s[3]||s[4]){p+=u;continue}else if((s[5]||s[6])&&i%3&&!((i+u)%3)){f+=u;continue}if(p-=u,p>0)continue;u=Math.min(u,u+p+f);const y=[...s[0]][0].length,b=t.slice(0,i+s.index+y+u);if(Math.min(i,u)%2){const M=b.slice(1,-1);return{type:"em",raw:b,text:M,tokens:this.lexer.inlineTokens(M)}}const x=b.slice(2,-2);return{type:"strong",raw:b,text:x,tokens:this.lexer.inlineTokens(x)}}}}codespan(t){const n=this.rules.inline.code.exec(t);if(n){let r=n[2].replace(/\n/g," ");const s=/[^ ]/.test(r),a=/^ /.test(r)&&/ $/.test(r);return s&&a&&(r=r.substring(1,r.length-1)),r=he(r,!0),{type:"codespan",raw:n[0],text:r}}}br(t){const n=this.rules.inline.br.exec(t);if(n)return{type:"br",raw:n[0]}}del(t){const n=this.rules.inline.del.exec(t);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(t){const n=this.rules.inline.autolink.exec(t);if(n){let r,s;return n[2]==="@"?(r=he(n[1]),s="mailto:"+r):(r=he(n[1]),s=r),{type:"link",raw:n[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let n;if(n=this.rules.inline.url.exec(t)){let s,a;if(n[2]==="@")s=he(n[0]),a="mailto:"+s;else{let i;do i=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(i!==n[0]);s=he(n[0]),n[1]==="www."?a="http://"+n[0]:a=n[0]}return{type:"link",raw:n[0],text:s,href:a,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){const n=this.rules.inline.text.exec(t);if(n){let r;return this.lexer.state.inRawBlock?r=n[0]:r=he(n[0]),{type:"text",raw:n[0],text:r}}}}const Wr=/^(?:[ \t]*(?:\n|$))+/,Gr=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Kr=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ot=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Zr=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,_n=/(?:[*+-]|\d{1,9}[.)])/,Mn=$(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,_n).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Ot=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Qr=/^[^\n]+/,$t=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Yr=$(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",$t).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Xr=$(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,_n).getRegex(),yt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Pt=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Jr=$("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Pt).replace("tag",yt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Rn=$(Ot).replace("hr",ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yt).getRegex(),Ft={blockquote:$(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Rn).getRegex(),code:Gr,def:Yr,fences:Kr,heading:Zr,hr:ot,html:Jr,lheading:Mn,list:Xr,newline:Wr,paragraph:Rn,table:nt,text:Qr},Bn=$("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yt).getRegex(),eo={...Ft,table:Bn,paragraph:$(Ot).replace("hr",ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Bn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yt).getRegex()},to={...Ft,html:$(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Pt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:nt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:$(Ot).replace("hr",ot).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Mn).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Ln=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,no=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Dn=/^( {2,}|\\)\n(?!\s*$)/,ro=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,st="\\p{P}\\p{S}",oo=$(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,st).getRegex(),so=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,ao=$(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,st).getRegex(),io=$("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,st).getRegex(),lo=$("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,st).getRegex(),co=$(/\\([punct])/,"gu").replace(/punct/g,st).getRegex(),uo=$(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),po=$(Pt).replace("(?:-->|$)","-->").getRegex(),fo=$("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",po).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),kt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ho=$(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",kt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),In=$(/^!?\[(label)\]\[(ref)\]/).replace("label",kt).replace("ref",$t).getRegex(),zn=$(/^!?\[(ref)\](?:\[\])?/).replace("ref",$t).getRegex(),mo=$("reflink|nolink(?!\\()","g").replace("reflink",In).replace("nolink",zn).getRegex(),Ht={_backpedal:nt,anyPunctuation:co,autolink:uo,blockSkip:so,br:Dn,code:no,del:nt,emStrongLDelim:ao,emStrongRDelimAst:io,emStrongRDelimUnd:lo,escape:Ln,link:ho,nolink:zn,punctuation:oo,reflink:In,reflinkSearch:mo,tag:fo,text:ro,url:nt},go={...Ht,link:$(/^!?\[(label)\]\((.*?)\)/).replace("label",kt).getRegex(),reflink:$(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",kt).getRegex()},Ut={...Ht,escape:$(Ln).replace("])","~|])").getRegex(),url:$(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},yo={...Ut,br:$(Dn).replace("{2,}","*").getRegex(),text:$(Ut.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},xt={normal:Ft,gfm:eo,pedantic:to},at={normal:Ht,gfm:Ut,breaks:yo,pedantic:go};class ge{constructor(t){F(this,"tokens");F(this,"options");F(this,"state");F(this,"tokenizer");F(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||qe,this.options.tokenizer=this.options.tokenizer||new gt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:xt.normal,inline:at.normal};this.options.pedantic?(n.block=xt.pedantic,n.inline=at.pedantic):this.options.gfm&&(n.block=xt.gfm,this.options.breaks?n.inline=at.breaks:n.inline=at.gfm),this.tokenizer.rules=n}static get rules(){return{block:xt,inline:at}}static lex(t,n){return new ge(n).lex(t)}static lexInline(t,n){return new ge(n).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){this.options.pedantic&&(t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""));let s,a,i;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(c=>(s=c.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))){if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length),s.raw.length===1&&n.length>0?n[n.length-1].raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length),a=n[n.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+s.raw,a.text+=`
`+s.text,this.inlineQueue[this.inlineQueue.length-1].src=a.text):n.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length),a=n[n.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+s.raw,a.text+=`
`+s.raw,this.inlineQueue[this.inlineQueue.length-1].src=a.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(i=t,this.options.extensions&&this.options.extensions.startBlock){let c=1/0;const u=t.slice(1);let p;this.options.extensions.startBlock.forEach(f=>{p=f.call({lexer:this},u),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(i=t.substring(0,c+1))}if(this.state.top&&(s=this.tokenizer.paragraph(i))){a=n[n.length-1],r&&(a==null?void 0:a.type)==="paragraph"?(a.raw+=`
`+s.raw,a.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):n.push(s),r=i.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length),a=n[n.length-1],a&&a.type==="text"?(a.raw+=`
`+s.raw,a.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):n.push(s);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r,s,a,i=t,c,u,p;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(c=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)f.includes(c[0].slice(c[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(c=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(c=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,c.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(u||(p=""),u=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(f=>(r=f.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),s=n[n.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):n.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),s=n[n.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):n.push(r);continue}if(r=this.tokenizer.emStrong(t,i,p)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.autolink(t)){t=t.substring(r.raw.length),n.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t))){t=t.substring(r.raw.length),n.push(r);continue}if(a=t,this.options.extensions&&this.options.extensions.startInline){let f=1/0;const k=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},k),typeof y=="number"&&y>=0&&(f=Math.min(f,y))}),f<1/0&&f>=0&&(a=t.substring(0,f+1))}if(r=this.tokenizer.inlineText(a)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(p=r.raw.slice(-1)),u=!0,s=n[n.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):n.push(r);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}}class bt{constructor(t){F(this,"options");F(this,"parser");this.options=t||qe}space(t){return""}code({text:t,lang:n,escaped:r}){var i;const s=(i=(n||"").match(/^\S*/))==null?void 0:i[0],a=t.replace(/\n$/,"")+`
`;return s?'<pre><code class="language-'+he(s)+'">'+(r?a:he(a,!0))+`</code></pre>
`:"<pre><code>"+(r?a:he(a,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:n}){return`<h${n}>${this.parser.parseInline(t)}</h${n}>
`}hr(t){return`<hr>
`}list(t){const n=t.ordered,r=t.start;let s="";for(let c=0;c<t.items.length;c++){const u=t.items[c];s+=this.listitem(u)}const a=n?"ol":"ul",i=n&&r!==1?' start="'+r+'"':"";return"<"+a+i+`>
`+s+"</"+a+`>
`}listitem(t){let n="";if(t.task){const r=this.checkbox({checked:!!t.checked});t.loose?t.tokens.length>0&&t.tokens[0].type==="paragraph"?(t.tokens[0].text=r+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=r+" "+t.tokens[0].tokens[0].text)):t.tokens.unshift({type:"text",raw:r+" ",text:r+" "}):n+=r+" "}return n+=this.parser.parse(t.tokens,!!t.loose),`<li>${n}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let n="",r="";for(let a=0;a<t.header.length;a++)r+=this.tablecell(t.header[a]);n+=this.tablerow({text:r});let s="";for(let a=0;a<t.rows.length;a++){const i=t.rows[a];r="";for(let c=0;c<i.length;c++)r+=this.tablecell(i[c]);s+=this.tablerow({text:r})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+s+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const n=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${t}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:n,tokens:r}){const s=this.parser.parseInline(r),a=Sn(t);if(a===null)return s;t=a;let i='<a href="'+t+'"';return n&&(i+=' title="'+n+'"'),i+=">"+s+"</a>",i}image({href:t,title:n,text:r}){const s=Sn(t);if(s===null)return r;t=s;let a=`<img src="${t}" alt="${r}"`;return n&&(a+=` title="${n}"`),a+=">",a}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):t.text}}class qt{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}}class ye{constructor(t){F(this,"options");F(this,"renderer");F(this,"textRenderer");this.options=t||qe,this.options.renderer=this.options.renderer||new bt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new qt}static parse(t,n){return new ye(n).parse(t)}static parseInline(t,n){return new ye(n).parseInline(t)}parse(t,n=!0){let r="";for(let s=0;s<t.length;s++){const a=t[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const c=a,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const i=a;switch(i.type){case"space":{r+=this.renderer.space(i);continue}case"hr":{r+=this.renderer.hr(i);continue}case"heading":{r+=this.renderer.heading(i);continue}case"code":{r+=this.renderer.code(i);continue}case"table":{r+=this.renderer.table(i);continue}case"blockquote":{r+=this.renderer.blockquote(i);continue}case"list":{r+=this.renderer.list(i);continue}case"html":{r+=this.renderer.html(i);continue}case"paragraph":{r+=this.renderer.paragraph(i);continue}case"text":{let c=i,u=this.renderer.text(c);for(;s+1<t.length&&t[s+1].type==="text";)c=t[++s],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u}]}):r+=u;continue}default:{const c='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n){n=n||this.renderer;let r="";for(let s=0;s<t.length;s++){const a=t[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=c||"";continue}}const i=a;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{const c='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}}class it{constructor(t){F(this,"options");F(this,"block");this.options=t||qe}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?ge.lex:ge.lexInline}provideParser(){return this.block?ye.parse:ye.parseInline}}F(it,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class ko{constructor(...t){F(this,"defaults",Vt());F(this,"options",this.setOptions);F(this,"parse",this.parseMarkdown(!0));F(this,"parseInline",this.parseMarkdown(!1));F(this,"Parser",ye);F(this,"Renderer",bt);F(this,"TextRenderer",qt);F(this,"Lexer",ge);F(this,"Tokenizer",gt);F(this,"Hooks",it);this.use(...t)}walkTokens(t,n){var s,a;let r=[];for(const i of t)switch(r=r.concat(n.call(this,i)),i.type){case"table":{const c=i;for(const u of c.header)r=r.concat(this.walkTokens(u.tokens,n));for(const u of c.rows)for(const p of u)r=r.concat(this.walkTokens(p.tokens,n));break}case"list":{const c=i;r=r.concat(this.walkTokens(c.items,n));break}default:{const c=i;(a=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&a[c.type]?this.defaults.extensions.childTokens[c.type].forEach(u=>{const p=c[u].flat(1/0);r=r.concat(this.walkTokens(p,n))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,n)))}}return r}use(...t){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{const s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const i=n.renderers[a.name];i?n.renderers[a.name]=function(...c){let u=a.renderer.apply(this,c);return u===!1&&(u=i.apply(this,c)),u}:n.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=n[a.level];i?i.unshift(a.tokenizer):n[a.level]=[a.tokenizer],a.start&&(a.level==="block"?n.startBlock?n.startBlock.push(a.start):n.startBlock=[a.start]:a.level==="inline"&&(n.startInline?n.startInline.push(a.start):n.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(n.childTokens[a.name]=a.childTokens)}),s.extensions=n),r.renderer){const a=this.defaults.renderer||new bt(this.defaults);for(const i in r.renderer){if(!(i in a))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const c=i,u=r.renderer[c],p=a[c];a[c]=(...f)=>{let k=u.apply(a,f);return k===!1&&(k=p.apply(a,f)),k||""}}s.renderer=a}if(r.tokenizer){const a=this.defaults.tokenizer||new gt(this.defaults);for(const i in r.tokenizer){if(!(i in a))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const c=i,u=r.tokenizer[c],p=a[c];a[c]=(...f)=>{let k=u.apply(a,f);return k===!1&&(k=p.apply(a,f)),k}}s.tokenizer=a}if(r.hooks){const a=this.defaults.hooks||new it;for(const i in r.hooks){if(!(i in a))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const c=i,u=r.hooks[c],p=a[c];it.passThroughHooks.has(i)?a[c]=f=>{if(this.defaults.async)return Promise.resolve(u.call(a,f)).then(y=>p.call(a,y));const k=u.call(a,f);return p.call(a,k)}:a[c]=(...f)=>{let k=u.apply(a,f);return k===!1&&(k=p.apply(a,f)),k}}s.hooks=a}if(r.walkTokens){const a=this.defaults.walkTokens,i=r.walkTokens;s.walkTokens=function(c){let u=[];return u.push(i.call(this,c)),a&&(u=u.concat(a.call(this,c))),u}}this.defaults={...this.defaults,...s}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,n){return ge.lex(t,n??this.defaults)}parser(t,n){return ye.parse(t,n??this.defaults)}parseMarkdown(t){return(r,s)=>{const a={...s},i={...this.defaults,...a},c=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return c(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=t);const u=i.hooks?i.hooks.provideLexer():t?ge.lex:ge.lexInline,p=i.hooks?i.hooks.provideParser():t?ye.parse:ye.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(r):r).then(f=>u(f,i)).then(f=>i.hooks?i.hooks.processAllTokens(f):f).then(f=>i.walkTokens?Promise.all(this.walkTokens(f,i.walkTokens)).then(()=>f):f).then(f=>p(f,i)).then(f=>i.hooks?i.hooks.postprocess(f):f).catch(c);try{i.hooks&&(r=i.hooks.preprocess(r));let f=u(r,i);i.hooks&&(f=i.hooks.processAllTokens(f)),i.walkTokens&&this.walkTokens(f,i.walkTokens);let k=p(f,i);return i.hooks&&(k=i.hooks.postprocess(k)),k}catch(f){return c(f)}}}onError(t,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const s="<p>An error occurred:</p><pre>"+he(r.message+"",!0)+"</pre>";return n?Promise.resolve(s):s}if(n)return Promise.reject(r);throw r}}}const ve=new ko;function V(o,t){return ve.parse(o,t)}V.options=V.setOptions=function(o){return ve.setOptions(o),V.defaults=ve.defaults,wn(V.defaults),V},V.getDefaults=Vt,V.defaults=qe,V.use=function(...o){return ve.use(...o),V.defaults=ve.defaults,wn(V.defaults),V},V.walkTokens=function(o,t){return ve.walkTokens(o,t)},V.parseInline=ve.parseInline,V.Parser=ye,V.parser=ye.parse,V.Renderer=bt,V.TextRenderer=qt,V.Lexer=ge,V.lexer=ge.lex,V.Tokenizer=gt,V.Hooks=it,V.parse=V,V.options,V.setOptions,V.use,V.walkTokens,V.parseInline,ye.parse,ge.lex;/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:Vn,setPrototypeOf:On,isFrozen:xo,getPrototypeOf:bo,getOwnPropertyDescriptor:wo}=Object;let{freeze:le,seal:ke,create:vt}=Object,{apply:jt,construct:Wt}=typeof Reflect<"u"&&Reflect;le||(le=function(t){return t}),ke||(ke=function(t){return t}),jt||(jt=function(t,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];return t.apply(n,s)}),Wt||(Wt=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return new t(...r)});const wt=ue(Array.prototype.forEach),Eo=ue(Array.prototype.lastIndexOf),$n=ue(Array.prototype.pop),lt=ue(Array.prototype.push),Co=ue(Array.prototype.splice),Et=ue(String.prototype.toLowerCase),Gt=ue(String.prototype.toString),Kt=ue(String.prototype.match),ct=ue(String.prototype.replace),To=ue(String.prototype.indexOf),So=ue(String.prototype.trim),Ce=ue(Object.prototype.hasOwnProperty),ce=ue(RegExp.prototype.test),ut=Ao(TypeError);function ue(o){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return jt(o,t,r)}}function Ao(o){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Wt(o,n)}}function D(o,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Et;On&&On(o,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const a=n(s);a!==s&&(xo(t)||(t[r]=a),s=a)}o[s]=!0}return o}function No(o){for(let t=0;t<o.length;t++)Ce(o,t)||(o[t]=null);return o}function Re(o){const t=vt(null);for(const[n,r]of Vn(o))Ce(o,n)&&(Array.isArray(r)?t[n]=No(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=Re(r):t[n]=r);return t}function dt(o,t){for(;o!==null;){const r=wo(o,t);if(r){if(r.get)return ue(r.get);if(typeof r.value=="function")return ue(r.value)}o=bo(o)}function n(){return null}return n}const Pn=le(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zt=le(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qt=le(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_o=le(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Yt=le(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Mo=le(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Fn=le(["#text"]),Hn=le(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Xt=le(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Un=le(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ct=le(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ro=ke(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bo=ke(/<%[\w\W]*|[\w\W]*%>/gm),Lo=ke(/\$\{[\w\W]*/gm),Do=ke(/^data-[\-\w.\u00B7-\uFFFF]+$/),Io=ke(/^aria-[\-\w]+$/),qn=ke(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),zo=ke(/^(?:\w+script|data):/i),Vo=ke(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vn=ke(/^html$/i),Oo=ke(/^[a-z][.\w]*(-[.\w]+)+$/i);var jn=Object.freeze({__proto__:null,ARIA_ATTR:Io,ATTR_WHITESPACE:Vo,CUSTOM_ELEMENT:Oo,DATA_ATTR:Do,DOCTYPE_NAME:vn,ERB_EXPR:Bo,IS_ALLOWED_URI:qn,IS_SCRIPT_OR_DATA:zo,MUSTACHE_EXPR:Ro,TMPLIT_EXPR:Lo});const pt={element:1,text:3,progressingInstruction:7,comment:8,document:9},$o=function(){return typeof window>"u"?null:window},Po=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const a="dompurify"+(r?"#"+r:"");try{return t.createPolicy(a,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Wn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Gn(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$o();const t=A=>Gn(A);if(t.version="3.3.0",t.removed=[],!o||!o.document||o.document.nodeType!==pt.document||!o.Element)return t.isSupported=!1,t;let{document:n}=o;const r=n,s=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:i,Node:c,Element:u,NodeFilter:p,NamedNodeMap:f=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:k,DOMParser:y,trustedTypes:b}=o,x=u.prototype,M=dt(x,"cloneNode"),h=dt(x,"remove"),E=dt(x,"nextSibling"),_=dt(x,"childNodes"),T=dt(x,"parentNode");if(typeof i=="function"){const A=n.createElement("template");A.content&&A.content.ownerDocument&&(n=A.content.ownerDocument)}let S,O="";const{implementation:W,createNodeIterator:Z,createDocumentFragment:ee,getElementsByTagName:xe}=n,{importNode:Ie}=r;let q=Wn();t.isSupported=typeof Vn=="function"&&typeof T=="function"&&W&&W.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:R,ERB_EXPR:G,TMPLIT_EXPR:de,DATA_ATTR:ze,ARIA_ATTR:Ne,IS_SCRIPT_OR_DATA:Te,ATTR_WHITESPACE:je,CUSTOM_ELEMENT:We}=jn;let{IS_ALLOWED_URI:Ge}=jn,v=null;const B=D({},[...Pn,...Zt,...Qt,...Yt,...Fn]);let w=null;const Q=D({},[...Hn,...Xt,...Un,...Ct]);let L=Object.seal(vt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Y=null,re=null;const oe=Object.seal(vt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let pe=!0,K=!0,se=!1,me=!0,be=!1,we=!0,Ee=!1,Ve=!1,Oe=!1,$e=!1,Ke=!1,Ye=!1,Tt=!0,d=!1;const g="user-content-";let I=!0,z=!1,H={},X=null;const Se=D({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let P=null;const _e=D({},["audio","video","img","source","image","track"]);let ft=null;const ir=D({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),St="http://www.w3.org/1998/Math/MathML",At="http://www.w3.org/2000/svg",Be="http://www.w3.org/1999/xhtml";let Xe=Be,tn=!1,nn=null;const xa=D({},[St,At,Be],Gt);let Nt=D({},["mi","mo","mn","ms","mtext"]),_t=D({},["annotation-xml"]);const ba=D({},["title","style","font","a","script"]);let ht=null;const wa=["application/xhtml+xml","text/html"],Ea="text/html";let ne=null,Je=null;const Ca=n.createElement("form"),lr=function(l){return l instanceof RegExp||l instanceof Function},rn=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Je&&Je===l)){if((!l||typeof l!="object")&&(l={}),l=Re(l),ht=wa.indexOf(l.PARSER_MEDIA_TYPE)===-1?Ea:l.PARSER_MEDIA_TYPE,ne=ht==="application/xhtml+xml"?Gt:Et,v=Ce(l,"ALLOWED_TAGS")?D({},l.ALLOWED_TAGS,ne):B,w=Ce(l,"ALLOWED_ATTR")?D({},l.ALLOWED_ATTR,ne):Q,nn=Ce(l,"ALLOWED_NAMESPACES")?D({},l.ALLOWED_NAMESPACES,Gt):xa,ft=Ce(l,"ADD_URI_SAFE_ATTR")?D(Re(ir),l.ADD_URI_SAFE_ATTR,ne):ir,P=Ce(l,"ADD_DATA_URI_TAGS")?D(Re(_e),l.ADD_DATA_URI_TAGS,ne):_e,X=Ce(l,"FORBID_CONTENTS")?D({},l.FORBID_CONTENTS,ne):Se,Y=Ce(l,"FORBID_TAGS")?D({},l.FORBID_TAGS,ne):Re({}),re=Ce(l,"FORBID_ATTR")?D({},l.FORBID_ATTR,ne):Re({}),H=Ce(l,"USE_PROFILES")?l.USE_PROFILES:!1,pe=l.ALLOW_ARIA_ATTR!==!1,K=l.ALLOW_DATA_ATTR!==!1,se=l.ALLOW_UNKNOWN_PROTOCOLS||!1,me=l.ALLOW_SELF_CLOSE_IN_ATTR!==!1,be=l.SAFE_FOR_TEMPLATES||!1,we=l.SAFE_FOR_XML!==!1,Ee=l.WHOLE_DOCUMENT||!1,$e=l.RETURN_DOM||!1,Ke=l.RETURN_DOM_FRAGMENT||!1,Ye=l.RETURN_TRUSTED_TYPE||!1,Oe=l.FORCE_BODY||!1,Tt=l.SANITIZE_DOM!==!1,d=l.SANITIZE_NAMED_PROPS||!1,I=l.KEEP_CONTENT!==!1,z=l.IN_PLACE||!1,Ge=l.ALLOWED_URI_REGEXP||qn,Xe=l.NAMESPACE||Be,Nt=l.MATHML_TEXT_INTEGRATION_POINTS||Nt,_t=l.HTML_INTEGRATION_POINTS||_t,L=l.CUSTOM_ELEMENT_HANDLING||{},l.CUSTOM_ELEMENT_HANDLING&&lr(l.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(L.tagNameCheck=l.CUSTOM_ELEMENT_HANDLING.tagNameCheck),l.CUSTOM_ELEMENT_HANDLING&&lr(l.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(L.attributeNameCheck=l.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),l.CUSTOM_ELEMENT_HANDLING&&typeof l.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(L.allowCustomizedBuiltInElements=l.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),be&&(K=!1),Ke&&($e=!0),H&&(v=D({},Fn),w=[],H.html===!0&&(D(v,Pn),D(w,Hn)),H.svg===!0&&(D(v,Zt),D(w,Xt),D(w,Ct)),H.svgFilters===!0&&(D(v,Qt),D(w,Xt),D(w,Ct)),H.mathMl===!0&&(D(v,Yt),D(w,Un),D(w,Ct))),l.ADD_TAGS&&(typeof l.ADD_TAGS=="function"?oe.tagCheck=l.ADD_TAGS:(v===B&&(v=Re(v)),D(v,l.ADD_TAGS,ne))),l.ADD_ATTR&&(typeof l.ADD_ATTR=="function"?oe.attributeCheck=l.ADD_ATTR:(w===Q&&(w=Re(w)),D(w,l.ADD_ATTR,ne))),l.ADD_URI_SAFE_ATTR&&D(ft,l.ADD_URI_SAFE_ATTR,ne),l.FORBID_CONTENTS&&(X===Se&&(X=Re(X)),D(X,l.FORBID_CONTENTS,ne)),I&&(v["#text"]=!0),Ee&&D(v,["html","head","body"]),v.table&&(D(v,["tbody"]),delete Y.tbody),l.TRUSTED_TYPES_POLICY){if(typeof l.TRUSTED_TYPES_POLICY.createHTML!="function")throw ut('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof l.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ut('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=l.TRUSTED_TYPES_POLICY,O=S.createHTML("")}else S===void 0&&(S=Po(b,s)),S!==null&&typeof O=="string"&&(O=S.createHTML(""));le&&le(l),Je=l}},cr=D({},[...Zt,...Qt,..._o]),ur=D({},[...Yt,...Mo]),Ta=function(l){let m=T(l);(!m||!m.tagName)&&(m={namespaceURI:Xe,tagName:"template"});const C=Et(l.tagName),U=Et(m.tagName);return nn[l.namespaceURI]?l.namespaceURI===At?m.namespaceURI===Be?C==="svg":m.namespaceURI===St?C==="svg"&&(U==="annotation-xml"||Nt[U]):!!cr[C]:l.namespaceURI===St?m.namespaceURI===Be?C==="math":m.namespaceURI===At?C==="math"&&_t[U]:!!ur[C]:l.namespaceURI===Be?m.namespaceURI===At&&!_t[U]||m.namespaceURI===St&&!Nt[U]?!1:!ur[C]&&(ba[C]||!cr[C]):!!(ht==="application/xhtml+xml"&&nn[l.namespaceURI]):!1},Me=function(l){lt(t.removed,{element:l});try{T(l).removeChild(l)}catch{h(l)}},Ze=function(l,m){try{lt(t.removed,{attribute:m.getAttributeNode(l),from:m})}catch{lt(t.removed,{attribute:null,from:m})}if(m.removeAttribute(l),l==="is")if($e||Ke)try{Me(m)}catch{}else try{m.setAttribute(l,"")}catch{}},dr=function(l){let m=null,C=null;if(Oe)l="<remove></remove>"+l;else{const J=Kt(l,/^[\r\n\t ]+/);C=J&&J[0]}ht==="application/xhtml+xml"&&Xe===Be&&(l='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+l+"</body></html>");const U=S?S.createHTML(l):l;if(Xe===Be)try{m=new y().parseFromString(U,ht)}catch{}if(!m||!m.documentElement){m=W.createDocument(Xe,"template",null);try{m.documentElement.innerHTML=tn?O:U}catch{}}const ie=m.body||m.documentElement;return l&&C&&ie.insertBefore(n.createTextNode(C),ie.childNodes[0]||null),Xe===Be?xe.call(m,Ee?"html":"body")[0]:Ee?m.documentElement:ie},pr=function(l){return Z.call(l.ownerDocument||l,l,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},on=function(l){return l instanceof k&&(typeof l.nodeName!="string"||typeof l.textContent!="string"||typeof l.removeChild!="function"||!(l.attributes instanceof f)||typeof l.removeAttribute!="function"||typeof l.setAttribute!="function"||typeof l.namespaceURI!="string"||typeof l.insertBefore!="function"||typeof l.hasChildNodes!="function")},fr=function(l){return typeof c=="function"&&l instanceof c};function Le(A,l,m){wt(A,C=>{C.call(t,l,m,Je)})}const hr=function(l){let m=null;if(Le(q.beforeSanitizeElements,l,null),on(l))return Me(l),!0;const C=ne(l.nodeName);if(Le(q.uponSanitizeElement,l,{tagName:C,allowedTags:v}),we&&l.hasChildNodes()&&!fr(l.firstElementChild)&&ce(/<[/\w!]/g,l.innerHTML)&&ce(/<[/\w!]/g,l.textContent)||l.nodeType===pt.progressingInstruction||we&&l.nodeType===pt.comment&&ce(/<[/\w]/g,l.data))return Me(l),!0;if(!(oe.tagCheck instanceof Function&&oe.tagCheck(C))&&(!v[C]||Y[C])){if(!Y[C]&&gr(C)&&(L.tagNameCheck instanceof RegExp&&ce(L.tagNameCheck,C)||L.tagNameCheck instanceof Function&&L.tagNameCheck(C)))return!1;if(I&&!X[C]){const U=T(l)||l.parentNode,ie=_(l)||l.childNodes;if(ie&&U){const J=ie.length;for(let fe=J-1;fe>=0;--fe){const De=M(ie[fe],!0);De.__removalCount=(l.__removalCount||0)+1,U.insertBefore(De,E(l))}}}return Me(l),!0}return l instanceof u&&!Ta(l)||(C==="noscript"||C==="noembed"||C==="noframes")&&ce(/<\/no(script|embed|frames)/i,l.innerHTML)?(Me(l),!0):(be&&l.nodeType===pt.text&&(m=l.textContent,wt([R,G,de],U=>{m=ct(m,U," ")}),l.textContent!==m&&(lt(t.removed,{element:l.cloneNode()}),l.textContent=m)),Le(q.afterSanitizeElements,l,null),!1)},mr=function(l,m,C){if(Tt&&(m==="id"||m==="name")&&(C in n||C in Ca))return!1;if(!(K&&!re[m]&&ce(ze,m))){if(!(pe&&ce(Ne,m))){if(!(oe.attributeCheck instanceof Function&&oe.attributeCheck(m,l))){if(!w[m]||re[m]){if(!(gr(l)&&(L.tagNameCheck instanceof RegExp&&ce(L.tagNameCheck,l)||L.tagNameCheck instanceof Function&&L.tagNameCheck(l))&&(L.attributeNameCheck instanceof RegExp&&ce(L.attributeNameCheck,m)||L.attributeNameCheck instanceof Function&&L.attributeNameCheck(m,l))||m==="is"&&L.allowCustomizedBuiltInElements&&(L.tagNameCheck instanceof RegExp&&ce(L.tagNameCheck,C)||L.tagNameCheck instanceof Function&&L.tagNameCheck(C))))return!1}else if(!ft[m]){if(!ce(Ge,ct(C,je,""))){if(!((m==="src"||m==="xlink:href"||m==="href")&&l!=="script"&&To(C,"data:")===0&&P[l])){if(!(se&&!ce(Te,ct(C,je,"")))){if(C)return!1}}}}}}}return!0},gr=function(l){return l!=="annotation-xml"&&Kt(l,We)},yr=function(l){Le(q.beforeSanitizeAttributes,l,null);const{attributes:m}=l;if(!m||on(l))return;const C={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let U=m.length;for(;U--;){const ie=m[U],{name:J,namespaceURI:fe,value:De}=ie,et=ne(J),sn=De;let ae=J==="value"?sn:So(sn);if(C.attrName=et,C.attrValue=ae,C.keepAttr=!0,C.forceKeepAttr=void 0,Le(q.uponSanitizeAttribute,l,C),ae=C.attrValue,d&&(et==="id"||et==="name")&&(Ze(J,l),ae=g+ae),we&&ce(/((--!?|])>)|<\/(style|title|textarea)/i,ae)){Ze(J,l);continue}if(et==="attributename"&&Kt(ae,"href")){Ze(J,l);continue}if(C.forceKeepAttr)continue;if(!C.keepAttr){Ze(J,l);continue}if(!me&&ce(/\/>/i,ae)){Ze(J,l);continue}be&&wt([R,G,de],xr=>{ae=ct(ae,xr," ")});const kr=ne(l.nodeName);if(!mr(kr,et,ae)){Ze(J,l);continue}if(S&&typeof b=="object"&&typeof b.getAttributeType=="function"&&!fe)switch(b.getAttributeType(kr,et)){case"TrustedHTML":{ae=S.createHTML(ae);break}case"TrustedScriptURL":{ae=S.createScriptURL(ae);break}}if(ae!==sn)try{fe?l.setAttributeNS(fe,J,ae):l.setAttribute(J,ae),on(l)?Me(l):$n(t.removed)}catch{Ze(J,l)}}Le(q.afterSanitizeAttributes,l,null)},Sa=function A(l){let m=null;const C=pr(l);for(Le(q.beforeSanitizeShadowDOM,l,null);m=C.nextNode();)Le(q.uponSanitizeShadowNode,m,null),hr(m),yr(m),m.content instanceof a&&A(m.content);Le(q.afterSanitizeShadowDOM,l,null)};return t.sanitize=function(A){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=null,C=null,U=null,ie=null;if(tn=!A,tn&&(A="<!-->"),typeof A!="string"&&!fr(A))if(typeof A.toString=="function"){if(A=A.toString(),typeof A!="string")throw ut("dirty is not a string, aborting")}else throw ut("toString is not a function");if(!t.isSupported)return A;if(Ve||rn(l),t.removed=[],typeof A=="string"&&(z=!1),z){if(A.nodeName){const De=ne(A.nodeName);if(!v[De]||Y[De])throw ut("root node is forbidden and cannot be sanitized in-place")}}else if(A instanceof c)m=dr("<!---->"),C=m.ownerDocument.importNode(A,!0),C.nodeType===pt.element&&C.nodeName==="BODY"||C.nodeName==="HTML"?m=C:m.appendChild(C);else{if(!$e&&!be&&!Ee&&A.indexOf("<")===-1)return S&&Ye?S.createHTML(A):A;if(m=dr(A),!m)return $e?null:Ye?O:""}m&&Oe&&Me(m.firstChild);const J=pr(z?A:m);for(;U=J.nextNode();)hr(U),yr(U),U.content instanceof a&&Sa(U.content);if(z)return A;if($e){if(Ke)for(ie=ee.call(m.ownerDocument);m.firstChild;)ie.appendChild(m.firstChild);else ie=m;return(w.shadowroot||w.shadowrootmode)&&(ie=Ie.call(r,ie,!0)),ie}let fe=Ee?m.outerHTML:m.innerHTML;return Ee&&v["!doctype"]&&m.ownerDocument&&m.ownerDocument.doctype&&m.ownerDocument.doctype.name&&ce(vn,m.ownerDocument.doctype.name)&&(fe="<!DOCTYPE "+m.ownerDocument.doctype.name+`>
`+fe),be&&wt([R,G,de],De=>{fe=ct(fe,De," ")}),S&&Ye?S.createHTML(fe):fe},t.setConfig=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};rn(A),Ve=!0},t.clearConfig=function(){Je=null,Ve=!1},t.isValidAttribute=function(A,l,m){Je||rn({});const C=ne(A),U=ne(l);return mr(C,U,m)},t.addHook=function(A,l){typeof l=="function"&&lt(q[A],l)},t.removeHook=function(A,l){if(l!==void 0){const m=Eo(q[A],l);return m===-1?void 0:Co(q[A],m,1)[0]}return $n(q[A])},t.removeHooks=function(A){q[A]=[]},t.removeAllHooks=function(){q=Wn()},t}var Fo=Gn();function Kn(){return{parseMarkdown:t=>{if(!t||typeof t!="string")return"";const n=hn(t),r=V.parse(n,{async:!1,breaks:!0,gfm:!0});return Fo.sanitize(r,{ALLOWED_TAGS:["p","br","strong","em","b","i","code","pre","ul","ol","li","h1","h2","h3","h4","h5","h6","a","blockquote","span","div","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","class","target","rel","data-mention-id","data-mention-type"],ALLOW_UNKNOWN_PROTOCOLS:!1,FORBID_ATTR:["onerror","onload","onclick","onmouseover"],KEEP_CONTENT:!0})}}}function Ho(){let o=null;function t(a){const i=a||document.querySelector("[data-rai-chat-container]");i&&requestAnimationFrame(()=>{i.scrollTo({top:i.scrollHeight,behavior:"smooth"})})}function n(a,i=100){const{scrollTop:c,scrollHeight:u,clientHeight:p}=a;return u-c-p<i}function r(a){a&&(s(),o=new MutationObserver(()=>{(a.scrollTop===0||n(a))&&requestAnimationFrame(()=>{a.scrollTo({top:a.scrollHeight,behavior:"smooth"})})}),o.observe(a,{childList:!0,subtree:!0}))}function s(){o&&(o.disconnect(),o=null)}return e.onUnmounted(()=>{s()}),{scrollToBottom:t,setupAutoScroll:r,cleanupAutoScroll:s}}function Uo(){const o=Ue(),t=e.computed(()=>o.error),n=e.computed(()=>{var a,i;return((a=t.value)==null?void 0:a.message)!==null&&((i=t.value)==null?void 0:i.message)!==void 0});return{errorState:t,hasError:n,retry:async()=>await o.retry(),clearError:()=>{o.clearError()}}}function Jt(){const o=Ue(),t=e.computed(()=>o.pageContext);function n(a){o.setPageContext(a)}function r(){o.setPageContext(null)}function s(a){const i=o.pageContext;i&&o.setPageContext({...i,...a,metadata:{...i.metadata,...a.metadata}})}return{context:t,setContext:n,clearContext:r,updateContext:s}}const Ae=[],Zn={id:"default",matcher:()=>!0,priority:0,getSuggestions:()=>{const o=j();return(o==null?void 0:o.defaultSuggestions)||[]}};function qo(){Ae.length=0;const o=j();o!=null&&o.suggestionProviders&&Ae.push(...o.suggestionProviders),Ae.push(Zn)}function vo(o,t){const n=[...Ae].sort((r,s)=>(s.priority||0)-(r.priority||0));for(const r of n)if(r.matcher&&r.matcher(o,t)||r.routes&&r.routes.some(a=>a.endsWith("*")?o.startsWith(a.slice(0,-1)):o===a||o.startsWith(a+"/")))return r;return Zn}function Qn(o,t){Ae.length===0&&qo();const n=vo(o,t),r=t||{pageType:"default",routePath:o};return n.extractContext&&(r.metadata={...r.metadata,...n.extractContext(o)}),n.getSuggestions(r)||[]}function jo(o){const t=Ae.findIndex(n=>n.id===o.id);if(t>=0)Ae[t]=o;else{const n=Ae.findIndex(r=>r.id==="default");n>=0?Ae.splice(n,0,o):Ae.push(o)}}const Wo=jo;function en(){const{context:o}=Jt(),t=Ue(),n=e.computed(()=>{var u;if(t.quota.remaining===0){const p=j();return(p==null?void 0:p.enableSupportMode)!==!1?[{id:"contact-support-quota",title:te("contactSupport"),description:te("noQuota"),prompt:"I need help with my account",className:"rai-suggestion--warning",isSupportRequest:!0}]:[]}const a=((u=o.value)==null?void 0:u.routePath)||(typeof window<"u"?window.location.pathname:"/"),i=Qn(a,o.value)||[],c=j();return c!=null&&c.can?i.filter(p=>!(p.permission&&!c.can(p.permission))):i}),r=e.computed(()=>o.value!==null&&o.value.pageType!=="default");function s(a){return typeof a.prompt=="function"?a.prompt(o.value||{pageType:"default"}):a.prompt}return{suggestions:n,hasContextualSuggestions:r,resolvePrompt:s}}function Go(o,t){const{setContext:n,clearContext:r,updateContext:s}=Jt();function a(){if(!t)return{};const c={};for(const[u,p]of Object.entries(t))c[u]=e.isRef(p)?p.value:p;return c}function i(){const c={pageType:o,routePath:typeof window<"u"?window.location.pathname:void 0,metadata:a()};n(c)}return e.onMounted(()=>{i()}),e.onUnmounted(()=>{r()}),t&&e.watch(()=>a(),c=>{s({metadata:c})},{deep:!0}),{setupContext:i}}function Ko(o){const t=o.toLowerCase().split("+");return{key:t.pop()||"",meta:t.includes("cmd")||t.includes("meta")||t.includes("command"),ctrl:t.includes("ctrl")||t.includes("control"),shift:t.includes("shift"),alt:t.includes("alt")||t.includes("option")}}function Zo(o,t){const n=o.key.toLowerCase(),r=t.meta?o.metaKey:!o.metaKey,s=t.ctrl?o.ctrlKey:!o.ctrlKey,a=t.shift?o.shiftKey:!o.shiftKey,i=t.alt?o.altKey:!o.altKey;let c=r&&s&&a&&i;return(t.meta&&!t.ctrl||!t.meta&&t.ctrl)&&(c=(o.metaKey||o.ctrlKey)&&a&&i),n===t.key&&c}function Yn(o){const{onToggle:t,enabled:n=!0}=o,r=e.ref(!1),s=o.shortcut!==void 0?o.shortcut:Fe("keyboardShortcut")??"cmd+g";if(s===null)return{isActive:r};const a=Ko(s);function i(c){if(!n)return;const u=c.target,p=u.tagName==="INPUT"||u.tagName==="TEXTAREA",f=u.isContentEditable,k=u.closest("[data-ai-input]");(p||f)&&!k||Zo(c,a)&&(c.preventDefault(),c.stopPropagation(),r.value=!r.value,t())}return e.onMounted(()=>{window.addEventListener("keydown",i,!0)}),e.onUnmounted(()=>{window.removeEventListener("keydown",i,!0)}),{isActive:r}}function Qo(o){return Yn({onToggle:()=>{o.value=!o.value}})}const Xn=e.defineComponent({__name:"AiAvatar",props:{ui:{}},setup(o){return(t,n)=>{var r;return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["w-6 h-6 min-w-[24px] flex items-center justify-center rounded-full border border-gray-300 dark:border-gray-600",(r=o.ui)==null?void 0:r.container])},[e.renderSlot(t.$slots,"default",{},()=>{var s;return[(e.openBlock(),e.createElementBlock("svg",{class:e.normalizeClass(["w-4 h-4 text-gray-400 dark:text-gray-500",(s=o.ui)==null?void 0:s.icon]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z"},null,-1)])],2))]})],2)}}}),Yo=e.defineComponent({__name:"UserAvatar",props:{ui:{}},setup(o){return(t,n)=>{var r;return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",(r=o.ui)==null?void 0:r.container])},[e.renderSlot(t.$slots,"default",{},()=>{var s;return[(e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:e.normalizeClass(["w-5 h-5 text-gray-500 dark:text-gray-400",(s=o.ui)==null?void 0:s.icon])},[...n[0]||(n[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z","clip-rule":"evenodd"},null,-1)])],2))]})],2)}}}),Xo=["onClick","onMouseenter"],Jn=e.defineComponent({__name:"MentionList",props:{items:{},selectedIndex:{default:0},providers:{default:()=>[]},ui:{},texts:{}},emits:["select","update:selectedIndex"],setup(o,{emit:t}){const n=o,r=e.computed(()=>n.ui||{}),s=t,a=e.ref(n.selectedIndex);e.watch(()=>n.selectedIndex,h=>{a.value=h}),e.watch(a,h=>{s("update:selectedIndex",h)});const i=e.computed(()=>{const h={};return n.items.forEach(E=>{const _=E.type||"default";h[_]||(h[_]=[]),h[_].push(E)}),h});function c(h){return n.providers.find(E=>E.type===h)||yn(h)}function u(h){const E=c(h);return(E==null?void 0:E.label)||h.charAt(0).toUpperCase()+h.slice(1)+"s"}function p(h,E){let _=0;const T=Object.keys(i.value);for(const S of T){if(S===h)return _+E;_+=i.value[S].length}return _}function f(h){s("select",h)}function k(h){a.value=h,s("update:selectedIndex",h)}function y(h){const E=c(h.type);return zt(h,E)}function b(h){const E=c(h.type);return gn(h,E)}function x(h){const E={employee:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",job:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",candidate:"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400",project:"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400",default:"bg-primary/10 text-primary"};return E[h]||E.default}function M(h){return h.split(" ").map(E=>E[0]).join("").slice(0,2).toUpperCase()}return(h,E)=>o.items.length>0?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["absolute bottom-full left-0 right-0 mb-2 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-lg max-h-60 overflow-y-auto z-50",r.value.root])},[e.createElementVNode("div",{class:e.normalizeClass(["p-2",r.value.container])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,(_,T)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:T},[Object.keys(i.value).length>1?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["px-3 py-1.5 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",r.value.groupHeader])},e.toDisplayString(u(T)),3)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(_,(S,O)=>(e.openBlock(),e.createElementBlock("button",{key:S.id,type:"button",class:e.normalizeClass(["w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors mb-0.5",[r.value.item,{[r.value.itemSelected||"bg-primary/10"]:p(T,O)===a.value,"hover:bg-gray-50 dark:hover:bg-gray-700":p(T,O)!==a.value}]]),onClick:W=>f(S),onMouseenter:W=>k(p(T,O))},[e.renderSlot(h.$slots,"item-icon",{item:S,type:T},()=>[e.createElementVNode("span",{class:e.normalizeClass(["w-8 h-8 flex items-center justify-center rounded-full text-xs font-semibold flex-shrink-0",[r.value.itemIcon,x(S.type)]])},e.toDisplayString(M(y(S))),3)]),e.createElementVNode("div",{class:e.normalizeClass(["flex-1 min-w-0",r.value.itemContent])},[e.createElementVNode("p",{class:e.normalizeClass(["text-sm font-medium text-gray-900 dark:text-gray-100 truncate",r.value.itemName])},e.toDisplayString(y(S)),3),b(S)?(e.openBlock(),e.createElementBlock("p",{key:0,class:e.normalizeClass(["text-xs text-gray-500 dark:text-gray-400 truncate",r.value.itemSubtitle])},e.toDisplayString(b(S)),3)):e.createCommentVNode("",!0)],2)],42,Xo))),128))],64))),128))],2)],2)):e.createCommentVNode("",!0)}}),Jo=["title"],es={key:0,class:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},er=e.defineComponent({__name:"ChatMessageActions",props:{message:{},ui:{},texts:{}},emits:["copy"],setup(o,{emit:t}){const n=o,r=t,s=u=>{var f;return(f=n.texts)!=null&&f[u]?n.texts[u]:te({copyToClipboard:"copyToClipboard",copied:"copied"}[u])},a=e.computed(()=>n.ui||{}),i=e.ref(!1);async function c(){try{await navigator.clipboard.writeText(n.message.message),i.value=!0,r("copy",n.message),setTimeout(()=>{i.value=!1},2e3)}catch(u){console.error("Failed to copy:",u)}}return(u,p)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",a.value.container])},[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",[a.value.button,a.value.copyButton]]),title:i.value?s("copied"):s("copyToClipboard"),onClick:c},[i.value?(e.openBlock(),e.createElementBlock("svg",{key:1,class:e.normalizeClass(["w-4 h-4 text-green-500",a.value.successState]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...p[1]||(p[1]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])],2)):(e.openBlock(),e.createElementBlock("svg",es,[...p[0]||(p[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"},null,-1)])]))],10,Jo)],2))}}),ts={class:"h-12 w-12 flex items-center justify-center rounded-lg bg-white/20 overflow-hidden"},ns=["src"],rs={key:1,class:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},os={class:"flex-1 min-w-0"},ss={class:"text-sm font-semibold text-white truncate"},as={class:"text-xs text-white/70"},is={key:0,class:"text-xs font-medium text-white/90"},ls={class:"flex-shrink-0 mt-0.5"},cs={class:"text-gray-600 dark:text-gray-400"},us=["id","innerHTML"],ds={class:"h-12 w-12 flex items-center justify-center rounded-lg bg-white dark:bg-gray-800 overflow-hidden border border-gray-200 dark:border-gray-600"},ps=["src"],fs={key:1,class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},hs={class:"flex-1 min-w-0"},ms={class:"text-sm font-semibold text-gray-800 dark:text-gray-200 truncate"},gs={class:"text-xs text-gray-500 dark:text-gray-400"},ys={key:0,class:"text-xs font-medium text-primary"},ks=e.defineComponent({__name:"ChatMessage",props:{message:{},showActions:{type:Boolean,default:!0},loadingText:{default:"Gathering data..."},ui:{},texts:{}},emits:["copy"],setup(o,{emit:t}){const n=o,r=t,s=h=>{var _;return(_=n.texts)!=null&&_[h]?n.texts[h]:{loadingText:"Gathering data...",showMore:"Show more",showLess:"Show less",openAttachment:"Open",attachment:"Attachment"}[h]||h},a=e.computed(()=>n.ui||{}),{parseMarkdown:i}=Kn(),c=e.ref(!1),u=e.computed(()=>n.message.attachments??[]),p=e.computed(()=>u.value.length>0),f=e.computed(()=>{if(n.message.role!=="user")return!1;const h=n.message.message||"",E=h.split(`
`).length;return h.length>200||E>4});function k(){c.value=!c.value}function y(h){return(h.type||"").startsWith("image/")?!0:/(png|jpe?g|gif|webp)$/i.test(h.name||"")}function b(h){if(h==null)return"";const E=typeof h=="string"?parseInt(h,10):h;return Number.isNaN(E)?"":E>=1024*1024?`${(E/(1024*1024)).toFixed(1)} MB`:E>=1024?`${Math.round(E/1024)} KB`:`${E} B`}const x=e.computed(()=>{if(n.message.role==="assistant"){let h=n.message.message;return h=h.replace(/\\n/g,`
`),i(h)}return n.message.message});function M(h){r("copy",h)}return(h,E)=>{var _;return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["group relative animate-in fade-in slide-in-from-bottom-2 duration-300",[a.value.root,{"flex justify-end":o.message.role==="user","flex justify-start":o.message.role==="assistant"}]])},[o.message.role==="user"?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["flex gap-3 justify-end",a.value.userMessage])},[e.createElementVNode("div",{class:e.normalizeClass(["rounded-2xl px-4 py-3 bg-primary text-white max-w-fit",a.value.userBubble])},[o.message.message?(e.openBlock(),e.createElementBlock("p",{key:0,class:e.normalizeClass(["text-sm whitespace-pre-wrap",[a.value.content,{"line-clamp-4":!c.value&&f.value}]])},e.toDisplayString(o.message.message),3)):e.createCommentVNode("",!0),f.value?(e.openBlock(),e.createElementBlock("button",{key:1,class:e.normalizeClass(["mt-2 text-xs text-white/80 hover:text-white underline",a.value.showMoreButton]),onClick:k},e.toDisplayString(c.value?s("showLess"):s("showMore")),3)):e.createCommentVNode("",!0),p.value?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["mt-3 space-y-2",a.value.attachmentsContainer])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,T=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(T.url?"a":"div"),{key:T.id,href:T.url||void 0,target:T.url?"_blank":void 0,rel:"noopener noreferrer",class:e.normalizeClass(["flex items-center gap-3 rounded-xl border border-white/20 bg-white/10 p-2 transition",[a.value.attachmentItem,T.url?"hover:bg-white/20 cursor-pointer":""]])},{default:e.withCtx(()=>[e.createElementVNode("div",ts,[T.url&&y(T)?(e.openBlock(),e.createElementBlock("img",{key:0,src:T.url,class:"object-cover h-full w-full",alt:""},null,8,ns)):(e.openBlock(),e.createElementBlock("svg",rs,[...E[0]||(E[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"},null,-1)])]))]),e.createElementVNode("div",os,[e.createElementVNode("p",ss,e.toDisplayString(T.name||s("attachment")),1),e.createElementVNode("p",as,e.toDisplayString(b(T.size)),1)]),T.url?(e.openBlock(),e.createElementBlock("span",is,e.toDisplayString(s("openAttachment")),1)):e.createCommentVNode("",!0)]),_:2},1032,["href","target","class"]))),128))],2)):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-primary",a.value.userAvatar])},[...E[1]||(E[1]=[e.createElementVNode("svg",{class:"h-4 w-4 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z","clip-rule":"evenodd"})],-1)])],2)],2)):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["flex items-start gap-3",a.value.assistantMessage])},[e.createElementVNode("div",ls,[e.createVNode(Xn)]),e.createElementVNode("div",{class:e.normalizeClass(["bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 px-5 py-4 shadow-sm rounded-2xl transition-all duration-200 flex-1",a.value.assistantBubble])},[o.message.loading?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["flex items-center gap-2 text-sm min-w-[150px]",a.value.loadingIndicator])},[e.createElementVNode("div",{class:e.normalizeClass(["flex space-x-1",a.value.loadingDots])},[...E[2]||(E[2]=[e.createElementVNode("div",{class:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{"animation-delay":"0ms"}},null,-1),e.createElementVNode("div",{class:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{"animation-delay":"150ms"}},null,-1),e.createElementVNode("div",{class:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{"animation-delay":"300ms"}},null,-1)])],2),e.createElementVNode("span",cs,e.toDisplayString(((_=o.texts)==null?void 0:_.loadingText)||o.loadingText),1)],2)):o.message.message?(e.openBlock(),e.createElementBlock("div",{key:1,id:o.message.id,class:e.normalizeClass(["prose prose-sm max-w-none prose-gray dark:prose-invert",a.value.content]),innerHTML:x.value},null,10,us)):e.createCommentVNode("",!0),!o.message.loading&&p.value?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["mt-4 space-y-2",a.value.attachmentsContainer])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,T=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(T.url?"a":"div"),{key:T.id,href:T.url||void 0,target:T.url?"_blank":void 0,rel:"noopener noreferrer",class:e.normalizeClass(["flex items-center gap-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 p-3 transition",[a.value.attachmentItem,T.url?"hover:bg-white dark:hover:bg-gray-600 cursor-pointer":""]])},{default:e.withCtx(()=>[e.createElementVNode("div",ds,[T.url&&y(T)?(e.openBlock(),e.createElementBlock("img",{key:0,src:T.url,class:"object-cover h-full w-full",alt:""},null,8,ps)):(e.openBlock(),e.createElementBlock("svg",fs,[...E[3]||(E[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"},null,-1)])]))]),e.createElementVNode("div",hs,[e.createElementVNode("p",ms,e.toDisplayString(T.name||s("attachment")),1),e.createElementVNode("p",gs,e.toDisplayString(b(T.size)),1)]),T.url?(e.openBlock(),e.createElementBlock("span",ys,e.toDisplayString(s("openAttachment")),1)):e.createCommentVNode("",!0)]),_:2},1032,["href","target","class"]))),128))],2)):e.createCommentVNode("",!0)],2)],2)),o.message.role==="assistant"&&!o.message.loading&&!o.message.streaming&&o.showActions?(e.openBlock(),e.createBlock(er,{key:2,message:o.message,class:e.normalizeClass(["absolute -bottom-8 left-14",a.value.actionsContainer]),onCopy:M},null,8,["message","class"])):e.createCommentVNode("",!0)],2)}}}),tr=(o,t)=>{const n=o.__vccOpts||o;for(const[r,s]of t)n[r]=s;return n},nr=tr(ks,[["__scopeId","data-v-57c4164f"]]),xs={class:"max-w-3xl mx-auto space-y-3"},bs=["accept"],ws={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide"},Es={class:"space-y-2"},Cs=["src"],Ts={key:1,class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ss={class:"flex-1 min-w-0"},As={class:"text-sm font-medium text-gray-800 dark:text-gray-200 truncate"},Ns={class:"text-xs text-gray-500 dark:text-gray-400"},_s={key:0,class:"mt-1 h-1 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden"},Ms={key:0,class:"text-xs text-gray-400"},Rs=["disabled","onClick"],Bs={class:"py-1"},Ls=["onClick","onMouseenter"],Ds={class:"flex items-start gap-3"},Is={class:"flex-1 min-w-0"},zs={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Vs={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-2"},Os=["title"],$s={class:"flex items-center"},Ps=["placeholder","disabled"],Fs={class:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1 z-10"},Hs=["title"],Us=["title"],qs=["disabled"],vs={key:0,class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},js={key:1,class:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor"},Ws={key:0,class:"flex justify-center"},rr=300,or=e.defineComponent({__name:"ChatInput",props:{modelValue:{},disabled:{type:Boolean,default:!1},sending:{type:Boolean,default:!1},placeholder:{default:"Ask me anything..."},supportPlaceholder:{default:"Describe your support request..."},minLength:{default:3},suggestions:{default:()=>[]},hasHistory:{type:Boolean,default:!1},supportRequestMode:{type:Boolean,default:!1},showSupportModeToggle:{type:Boolean,default:!1},contextLinkText:{default:""},ui:{},texts:{}},emits:["update:modelValue","submit","cancel","suggestion-select","toggle-support-mode","context-link-click"],setup(o,{emit:t}){const n=o,r=e.computed(()=>n.ui||{}),s=t,a=e.ref(n.modelValue),i=e.ref(null),c=e.ref(null),u=e.ref(!1),p=e.ref(!1),f=e.ref(0),k=e.ref(!1),y=e.ref(-1),b=e.ref(null),x=e.ref(!1),M=e.ref([]),h=e.ref(0),E=e.ref({inMention:!1,query:"",startPos:0}),_=e.ref([]),T=e.computed(()=>{const d=j();return(d==null?void 0:d.mentionProviders)||[]}),S=e.ref([]),O=Fe("maxAttachments")||5,W=Fe("maxFileSize")||10*1024*1024,Z=Fe("acceptedFileTypes")||"image/*,.pdf,.txt,.doc,.docx,.xls,.xlsx,.csv",ee=e.computed(()=>n.supportRequestMode?n.supportPlaceholder:n.placeholder),xe=e.computed(()=>n.showSupportModeToggle?n.supportRequestMode?"pr-32":"pr-24":"pr-14");e.watch(()=>n.modelValue,d=>{a.value=d,e.nextTick(R)}),e.watch(a,d=>{s("update:modelValue",d),e.nextTick(R),Te(d)});const Ie=e.computed(()=>S.value.length>0),q=e.computed(()=>S.value.some(d=>d.uploading));function R(){const d=i.value;if(!d)return;d.style.height="auto";const g=Math.min(d.scrollHeight,rr);d.style.height=`${g}px`,d.style.overflowY=d.scrollHeight>rr?"auto":"hidden"}const G=e.computed(()=>{var g;return(((g=a.value)==null?void 0:g.trim())??"").length>=n.minLength?!0:Ie.value}),de=e.computed(()=>!n.disabled&&!n.sending&&G.value&&!q.value);function ze(){R()}function Ne(){s("toggle-support-mode")}function Te(d){const g=i.value;if(!g)return;const I=g.selectionStart,z=mn(d,I);E.value=z,z.inMention&&z.query.length>=0?je(z.query):(x.value=!1,M.value=[])}async function je(d){const g=kn();if(g.length===0){x.value=!1;return}const I=[];for(const z of g)try{const H=await z.search(d);I.push(...H.map(X=>({...X,type:z.type})))}catch(H){console.warn(`Mention provider ${z.type} failed:`,H)}M.value=I.slice(0,10),x.value=I.length>0,h.value=0}function We(d){var X;const{startPos:g}=E.value,I=a.value.slice(0,g),z=a.value.slice(((X=i.value)==null?void 0:X.selectionStart)||g),H=d.name||d.label||d.title||d.id;a.value=`${I}@${H} ${z}`,_.value.push({id:d.id,name:H,type:d.type,metadata:d.attributes}),x.value=!1,M.value=[],e.nextTick(()=>{var P,_e;(P=i.value)==null||P.focus();const Se=I.length+H.length+2;(_e=i.value)==null||_e.setSelectionRange(Se,Se)})}function Ge(){e.nextTick(()=>{const d=b.value;if(!d)return;const g=d.querySelector(`li:nth-child(${y.value+1})`);g&&g.scrollIntoView({block:"nearest",behavior:"smooth"})})}function v(d){if(x.value&&M.value.length>0){if(d.key==="ArrowDown"){d.preventDefault(),h.value=Math.min(h.value+1,M.value.length-1);return}if(d.key==="ArrowUp"){d.preventDefault(),h.value=Math.max(h.value-1,0);return}if(d.key==="Enter"||d.key==="Tab"){d.preventDefault();const g=M.value[h.value];g&&We(g);return}if(d.key==="Escape"){d.preventDefault(),x.value=!1;return}}if(k.value&&n.suggestions.length>0){if(d.key==="ArrowDown"){d.preventDefault(),y.value=Math.min(y.value+1,n.suggestions.length-1),Ge();return}if(d.key==="ArrowUp"){d.preventDefault(),y.value=Math.max(y.value-1,0),Ge();return}if(d.key==="Enter"&&y.value>=0){d.preventDefault();const g=n.suggestions[y.value];g&&Ke(g);return}if(d.key==="Escape"){d.preventDefault(),k.value=!1,y.value=-1;return}}if(d.key==="Enter"){if(d.shiftKey)return;!n.sending&&de.value&&(d.preventDefault(),B())}}function B(){if(!de.value)return;const d=be(),g=a.value.trim(),I=[..._.value];s("submit",{message:g,attachments:d,mentions:I,isSupportRequest:n.supportRequestMode}),a.value="",me(),_.value=[],e.nextTick(R)}function w(){n.sending?s("cancel"):de.value&&B()}function Q(){var d;n.disabled||n.sending||S.value.length>=O||(d=c.value)==null||d.click()}function L(d){const g=d.target,I=g.files;I&&I.length&&Y(I),g.value=""}function Y(d){if(!d)return;const g=Array.from(d);for(const I of g){if(S.value.length>=O)break;I.size>W||re(I)}}function re(d){var Se;const g=crypto.randomUUID(),I=d.type.startsWith("image/")?URL.createObjectURL(d):void 0,z=j(),H=!!((Se=z==null?void 0:z.endpoints)!=null&&Se.uploadFile),X={id:g,name:d.name,type:d.type,size:d.size,uploading:H,progress:H?0:100,previewUrl:I};S.value.push(X),H&&oe(d,g)}async function oe(d,g){const I=Ue();try{const z=await I.uploadFile(d),H=S.value.findIndex(X=>X.id===g);if(H===-1)return;if(z){const X=S.value[H].previewUrl;S.value[H]={...S.value[H],id:z.id||g,url:z.url,extractedText:z.extractedText,uploading:!1,progress:100,previewUrl:X||z.previewUrl}}else se(g)}catch{se(g)}}function pe(d){return(d.type||"").startsWith("image/")?!0:/(png|jpe?g|gif|webp)$/i.test(d.name)}function K(d){if(d==null)return"";const g=typeof d=="string"?parseInt(d,10):d;return Number.isNaN(g)?"":g>=1024*1024?`${(g/(1024*1024)).toFixed(1)} MB`:g>=1024?`${Math.round(g/1024)} KB`:`${g} B`}function se(d){const g=S.value.findIndex(z=>z.id===d);if(g===-1)return;const[I]=S.value.splice(g,1);I!=null&&I.previewUrl&&URL.revokeObjectURL(I.previewUrl)}function me(){S.value.forEach(d=>{d.previewUrl&&URL.revokeObjectURL(d.previewUrl)}),S.value=[]}function be(){return S.value.filter(d=>!d.uploading).map(d=>({id:d.id,name:d.name,url:d.url,type:d.type,size:d.size}))}function we(d){var g;return Array.from(((g=d.dataTransfer)==null?void 0:g.types)||[]).includes("Files")}function Ee(d){we(d)&&(f.value+=1,p.value=!0)}function Ve(d){we(d)||d.preventDefault()}function Oe(d){we(d)&&(f.value=Math.max(0,f.value-1),f.value===0&&(p.value=!1))}function $e(d){var g;we(d)&&(f.value=0,p.value=!1,Y(((g=d.dataTransfer)==null?void 0:g.files)||null))}function Ke(d){s("suggestion-select",d),k.value=!1,y.value=-1,e.nextTick(()=>{var g;return(g=i.value)==null?void 0:g.focus()})}function Ye(){u.value=!0}function Tt(){u.value=!1,setTimeout(()=>{k.value=!1,x.value=!1,y.value=-1},200)}return e.watch(a,d=>{d&&!n.hasHistory&&u.value&&n.suggestions.length>0?k.value=!0:k.value=!1}),e.watch(()=>n.suggestions,d=>{a.value&&!n.hasHistory&&u.value&&d.length>0?k.value=!0:d.length===0&&(k.value=!1)}),e.onMounted(()=>{e.nextTick(R)}),e.onBeforeUnmount(()=>{me()}),(d,g)=>{var I,z,H,X,Se;return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["px-4 pb-4 bg-white dark:bg-gray-900 sticky bottom-0",r.value.root]),onDragenter:e.withModifiers(Ee,["prevent"]),onDragover:e.withModifiers(Ve,["prevent"]),onDragleave:e.withModifiers(Oe,["prevent"]),onDrop:e.withModifiers($e,["prevent"])},[e.createElementVNode("form",{onSubmit:e.withModifiers(B,["prevent"]),class:e.normalizeClass(r.value.form)},[e.createElementVNode("div",xs,[e.createElementVNode("input",{ref_key:"fileInputRef",ref:c,type:"file",class:"hidden",multiple:"",accept:e.unref(Z),onChange:L},null,40,bs),S.value.length?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["border border-gray-200 dark:border-gray-700 rounded-2xl p-3 bg-gray-50 dark:bg-gray-800 space-y-3",r.value.attachmentsContainer])},[e.createElementVNode("p",ws,e.toDisplayString(((I=o.texts)==null?void 0:I.attachedFiles)||"Attached files"),1),e.createElementVNode("ul",Es,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(S.value,P=>(e.openBlock(),e.createElementBlock("li",{key:P.id,class:e.normalizeClass(["flex items-center gap-3 rounded-xl bg-white dark:bg-gray-700 p-2 shadow-sm border border-gray-100 dark:border-gray-600",r.value.attachmentItem])},[e.createElementVNode("div",{class:e.normalizeClass(["h-10 w-10 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-600 overflow-hidden",r.value.attachmentThumbnail])},[pe(P)?(e.openBlock(),e.createElementBlock("img",{key:0,src:P.previewUrl||P.url,class:"object-cover h-full w-full",alt:""},null,8,Cs)):(e.openBlock(),e.createElementBlock("svg",Ts,[...g[3]||(g[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"},null,-1)])]))],2),e.createElementVNode("div",Ss,[e.createElementVNode("p",As,e.toDisplayString(P.name),1),e.createElementVNode("p",Ns,e.toDisplayString(K(P.size)),1),P.uploading?(e.openBlock(),e.createElementBlock("div",_s,[e.createElementVNode("div",{class:"h-full bg-primary transition-all",style:e.normalizeStyle({width:`${P.progress??10}%`})},null,4)])):e.createCommentVNode("",!0)]),P.uploading?(e.openBlock(),e.createElementBlock("span",Ms,e.toDisplayString(Math.round(P.progress??0))+"% ",1)):e.createCommentVNode("",!0),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",r.value.attachmentRemove]),disabled:P.uploading,onClick:_e=>se(P.id)},[...g[4]||(g[4]=[e.createElementVNode("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M6 18L18 6M6 6l12 12"})],-1)])],10,Rs)],2))),128))])],2)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["relative",r.value.inputContainer])},[e.createVNode(e.Transition,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:e.withCtx(()=>[k.value&&o.suggestions.length>0?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"dropdownRef",ref:b,class:e.normalizeClass(["absolute bottom-full left-0 right-0 mb-2 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-lg max-h-80 overflow-y-auto z-10",r.value.suggestionsDropdown])},[e.createElementVNode("ul",Bs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.suggestions,(P,_e)=>(e.openBlock(),e.createElementBlock("li",{key:P.id,class:e.normalizeClass(["px-4 py-3 cursor-pointer transition-colors border-b border-gray-100 dark:border-gray-700 last:border-b-0",[r.value.suggestionItem,{[r.value.suggestionItemSelected||"bg-primary/10"]:_e===y.value,"hover:bg-gray-50 dark:hover:bg-gray-700":_e!==y.value}]]),onClick:ft=>Ke(P),onMouseenter:ft=>y.value=_e},[e.createElementVNode("div",Ds,[e.createElementVNode("div",Is,[e.createElementVNode("p",zs,e.toDisplayString(P.title),1),e.createElementVNode("p",Vs,e.toDisplayString(P.description),1)])])],42,Ls))),128))])],2)):e.createCommentVNode("",!0)]),_:1}),e.createVNode(e.Transition,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:e.withCtx(()=>[x.value&&M.value.length>0?(e.openBlock(),e.createBlock(Jn,{key:0,items:M.value,"selected-index":h.value,providers:T.value,onSelect:We,"onUpdate:selectedIndex":g[0]||(g[0]=P=>h.value=P)},null,8,["items","selected-index","providers"])):e.createCommentVNode("",!0)]),_:1}),e.createElementVNode("div",{class:e.normalizeClass(["rounded-2xl border shadow-lg transition-all duration-200 bg-white dark:bg-gray-800",[r.value.inputWrapper,{"border-primary shadow-primary/30":u.value||p.value,"border-gray-200 dark:border-gray-700 shadow-gray-100 dark:shadow-gray-900":!u.value&&!p.value}]])},[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["absolute left-3 top-1/2 -translate-y-1/2 h-9 w-9 rounded-xl flex items-center justify-center text-gray-500 dark:text-gray-400 hover:text-primary transition z-10",r.value.attachButton]),title:((z=o.texts)==null?void 0:z.attachFiles)||"Attach files",onClick:Q},[...g[5]||(g[5]=[e.createElementVNode("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})],-1)])],10,Os),e.createElementVNode("div",$s,[e.withDirectives(e.createElementVNode("textarea",{ref_key:"textareaRef",ref:i,"onUpdate:modelValue":g[1]||(g[1]=P=>a.value=P),rows:"1","data-ai-input":"",placeholder:ee.value,disabled:o.disabled,class:e.normalizeClass(["block w-full bg-transparent py-3 text-sm leading-5 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-500 border-0 focus:outline-none focus-visible:outline-none resize-none pl-12",[r.value.textarea,xe.value]]),onInput:ze,onKeydown:v,onFocus:Ye,onBlur:Tt},null,42,Ps),[[e.vModelText,a.value]])]),e.createElementVNode("div",Fs,[o.showSupportModeToggle&&!o.supportRequestMode?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:e.normalizeClass(["h-9 w-9 rounded-xl flex items-center justify-center text-gray-400 hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition flex-shrink-0",r.value.supportToggle]),title:((H=o.texts)==null?void 0:H.toggleSupportMode)||e.unref(te)("toggleSupportMode"),onClick:Ne},[...g[6]||(g[6]=[e.createElementVNode("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})],-1)])],10,Hs)):e.createCommentVNode("",!0),o.showSupportModeToggle&&o.supportRequestMode?(e.openBlock(),e.createElementBlock("button",{key:1,type:"button",class:e.normalizeClass(["h-7 px-2 rounded-lg flex items-center gap-1 text-xs font-medium bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 hover:bg-amber-200 dark:hover:bg-amber-900/50 transition flex-shrink-0",r.value.supportBadge]),title:((X=o.texts)==null?void 0:X.exitSupportMode)||e.unref(te)("exitSupportMode"),onClick:Ne},[g[7]||(g[7]=e.createElementVNode("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(((Se=o.texts)==null?void 0:Se.supportLabel)||"Support"),1),g[8]||(g[8]=e.createElementVNode("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1))],10,Us)):e.createCommentVNode("",!0),e.createElementVNode("button",{disabled:!de.value&&!o.sending,class:e.normalizeClass(["h-9 w-9 rounded-xl flex items-center justify-center transition-all duration-200 flex-shrink-0",[r.value.sendButton,{[r.value.sendButtonActive||"bg-primary text-white hover:bg-primary/90"]:de.value&&!o.sending,[r.value.stopButton||"bg-red-500 text-white hover:bg-red-600"]:o.sending,[r.value.sendButtonDisabled||"bg-gray-200 dark:bg-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"]:!de.value&&!o.sending}]]),type:"button",onClick:e.withModifiers(w,["prevent"])},[o.sending?(e.openBlock(),e.createElementBlock("svg",js,[...g[10]||(g[10]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M4.5 7.5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-9a3 3 0 01-3-3v-9z","clip-rule":"evenodd"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",vs,[...g[9]||(g[9]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"},null,-1)])]))],10,qs)])],2)],2),e.renderSlot(d.$slots,"context-link",{},()=>[o.contextLinkText?(e.openBlock(),e.createElementBlock("div",Ws,[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["text-xs text-gray-400 hover:text-primary transition-colors",r.value.contextLink]),onClick:g[2]||(g[2]=P=>d.$emit("context-link-click"))},e.toDisplayString(o.contextLinkText),3)])):e.createCommentVNode("",!0)])])],34)],34)}}}),Gs=["onClick"],sr=e.defineComponent({__name:"AiEmptyState",props:{ui:{},texts:{}},emits:["item-click"],setup(o,{emit:t}){const n=o,r=t,s=y=>{var x;return(x=n.texts)!=null&&x[y]?n.texts[y]:te({aiName:"aiName",title:"emptyStateTitle",description:"emptyStateDescription"}[y])},a=e.computed(()=>n.ui||{}),{suggestions:i,resolvePrompt:c}=en();function u(y){const b={...y,prompt:c(y)};r("item-click",b)}function p(y){return y.gradientClass?y.gradientClass:y.className?y.className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900"}function f(y){const b=y.category||"default",x={hr:"bg-blue-100 dark:bg-blue-900/30",finance:"bg-green-100 dark:bg-green-900/30",analytics:"bg-purple-100 dark:bg-purple-900/30",support:"bg-amber-100 dark:bg-amber-900/30",default:"bg-primary/10"};return x[b]||x.default}function k(y){const b=y.category||"default",x={hr:"text-blue-600 dark:text-blue-400",finance:"text-green-600 dark:text-green-400",analytics:"text-purple-600 dark:text-purple-400",support:"text-amber-600 dark:text-amber-400",default:"text-primary"};return x[b]||x.default}return(y,b)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex items-center justify-center p-4 h-full",a.value.root])},[e.createElementVNode("div",{class:e.normalizeClass(["w-full max-w-4xl",a.value.content])},[e.createElementVNode("div",{class:e.normalizeClass(["mb-8 text-center",a.value.header])},[e.createElementVNode("div",{class:e.normalizeClass(["mb-3 inline-flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2 text-sm font-medium text-primary",a.value.badge])},[b[0]||(b[0]=e.createElementVNode("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(s("aiName")),1)],2),e.createElementVNode("h1",{class:e.normalizeClass(["mb-3 text-4xl font-bold tracking-tight text-gray-900 dark:text-white",a.value.title])},e.toDisplayString(s("title")),3),e.createElementVNode("p",{class:e.normalizeClass(["text-gray-600 dark:text-gray-400",a.value.description])},e.toDisplayString(s("description")),3)],2),e.createElementVNode("div",{class:e.normalizeClass(["mb-8 grid gap-3 sm:grid-cols-2 lg:grid-cols-3",a.value.grid])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(x,M)=>(e.openBlock(),e.createElementBlock("button",{key:x.id||M,class:e.normalizeClass(["group relative overflow-hidden rounded-xl border border-gray-300 dark:border-gray-600 p-4 text-left transition-all hover:shadow-md hover:scale-[1.02]",[a.value.suggestionCard,p(x)]]),onClick:h=>u(x)},[e.createElementVNode("div",{class:e.normalizeClass(["mb-2 inline-flex h-10 w-10 items-center justify-center rounded-lg",[a.value.suggestionIconContainer,f(x)]])},[x.icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(x.icon),{key:0,class:e.normalizeClass(["h-5 w-5",[a.value.suggestionIcon,k(x)]])},null,8,["class"])):(e.openBlock(),e.createElementBlock("svg",{key:1,class:e.normalizeClass(["h-5 w-5",[a.value.suggestionIcon,k(x)]]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[...b[1]||(b[1]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z"},null,-1)])],2))],2),e.createElementVNode("h3",{class:e.normalizeClass(["mb-1 text-sm font-semibold text-gray-900 dark:text-white",a.value.suggestionTitle])},e.toDisplayString(x.title),3),e.createElementVNode("p",{class:e.normalizeClass(["text-xs text-gray-600 dark:text-gray-400",a.value.suggestionDescription])},e.toDisplayString(x.description),3)],10,Gs))),128))],2)],2)],2))}}),Ks={class:"flex items-center gap-3"},Zs={key:1,class:"text-xs text-gray-400 dark:text-gray-500 font-medium"},Qs={key:1,class:"flex items-center gap-2"},Ys={key:0,class:"flex items-center gap-2 ml-auto mr-3"},Xs=["title"],Js=["title"],ea=["title"],ta={key:0,class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},na={key:1,class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},ra={key:0,class:"flex-1 flex flex-col items-center justify-center p-6 overflow-y-auto"},oa={class:"w-full max-w-md"},sa={class:"bg-gray-900 rounded-xl overflow-hidden"},aa={class:"flex items-center justify-between px-4 py-2 bg-gray-800/50 border-b border-gray-700"},ia={key:0,class:"flex-1 flex flex-col overflow-y-auto"},la={class:"max-w-3xl mx-auto px-4 space-y-6"},ca={class:"flex justify-center"},ua={class:"inline-flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2 text-sm font-medium text-primary"},da={key:0,class:"flex justify-center"},pa=["title"],fa={key:0,class:"absolute inset-0 bg-black/50 flex items-center justify-center z-10"},ha={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},ma={class:"text-sm text-gray-600 dark:text-gray-400 mb-6"},ga={class:"flex justify-end gap-3"},ya=`import { RestifyAiPlugin } from '@doderasoftware/restify-ai'

app.use(RestifyAiPlugin, {
  endpoints: {
    ask: '/api/ai/ask',
    quota: '/api/ai/quota', // optional
  },
  getAuthToken: () => getToken(),
})`,ka=tr(e.defineComponent({__name:"AiChatDrawer",props:{modelValue:{type:Boolean},ui:{},texts:{},width:{default:"600px"},fullscreenWidth:{default:"90vw"},position:{default:"right"},showBackdrop:{type:Boolean,default:!1},closeOnBackdropClick:{type:Boolean,default:!1},closeOnEscape:{type:Boolean,default:!0},showQuota:{type:Boolean,default:!0},showFullscreenToggle:{type:Boolean,default:!0},showMinimizeButton:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},showNewChatButton:{type:Boolean,default:!0},confirmClose:{type:Boolean,default:!0}},emits:["update:modelValue","close","contact-support","new-chat"],setup(o,{emit:t}){const n=o,r=t,s=e.computed({get:()=>n.modelValue,set:B=>r("update:modelValue",B)});function a(B,w){var L;const Q=(L=n.texts)==null?void 0:L[B];if(Q){let Y=Q;if(w)for(const[re,oe]of Object.entries(w))Y=Y.replace(`{${re}}`,String(oe));return Y}return te(B,w)}const i=Ue(),c=e.ref(""),u=e.ref(te("loadingText")),p=e.ref(null),f=e.ref(!1),k=e.ref(!1),y=e.ref(!1),b=e.computed(()=>!Rt()),x=e.computed(()=>Fe("enableSupportMode")??!1),{suggestions:M,resolvePrompt:h}=en();function E(){navigator.clipboard.writeText(ya),k.value=!0,setTimeout(()=>{k.value=!1},2e3)}const _=e.computed(()=>{if(b.value)return[];const B=c.value.toLowerCase().trim(),w=M.value||[];let Q=w;if(B){const L=new Set(["a","an","the","and","or","but","in","on","at","to","for","of","with","by"]),Y=B.split(/\s+/).filter(re=>!L.has(re));Y.length>0&&(Q=w.filter(re=>{const oe=`${re.title} ${re.description||""}`.toLowerCase();return Y.every(pe=>oe.includes(pe))}))}return Q.slice(0,5).map(L=>({id:L.id,title:L.title,description:L.description||""}))}),T=e.computed(()=>({quota:i.quota,isFullscreen:f.value,hasHistory:i.chatHistory.length>0,onNewChat:de,onClose:ee,onMinimize:Z,onToggleFullscreen:W})),S=e.computed(()=>({modelValue:c.value,sending:i.sending,disabled:!1,onSubmit:We,onCancel:()=>i.cancelRequest()}));function O(B){const w=(M.value||[]).find(Q=>Q.id===B.id);w&&(c.value=h(w))}function W(){f.value=!f.value}function Z(){s.value=!1}function ee(){n.confirmClose&&!b.value&&i.chatHistory.length>0?y.value=!0:(s.value=!1,r("close"))}function xe(){y.value=!1,i.clearChatHistory(),s.value=!1,r("close")}function Ie(){r("contact-support")}function q(){i.toggleSupportMode()}async function R(){await e.nextTick();const B=document.getElementById("rai-chat-bottom");B&&B.scrollIntoView({behavior:"smooth",block:"end"})}function G(B){c.value=B.prompt,i.clearError()}function de(){i.clearChatHistory(),r("new-chat")}function ze(B){}function Ne(B){return new Promise(w=>setTimeout(w,B))}function Te(){u.value=te("loadingText")}async function je(){if(u.value=te("loadingText"),await Ne(2e3),!i.sending){Te();return}if(u.value=te("analyzingText"),await Ne(3e3),!i.sending){Te();return}u.value=te("craftingText")}async function We(B){const{message:w,attachments:Q,mentions:L,isSupportRequest:Y}=B;if(i.sending)return;i.clearError(),je(),await e.nextTick(),R();const re=L.map(pe=>({id:pe.id,name:pe.name,type:pe.type||"unknown",metadata:pe.metadata})),oe=await i.askQuestion(w,Q,re,Y);Te(),oe&&R()}async function Ge(){je();const B=await i.retry();Te(),B&&R()}function v(B){n.closeOnEscape&&B.key==="Escape"&&s.value&&(y.value?y.value=!1:Z())}return e.onMounted(()=>{window.addEventListener("keydown",v)}),e.onUnmounted(()=>{window.removeEventListener("keydown",v)}),(B,w)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createVNode(e.Transition,{name:"rai-fade"},{default:e.withCtx(()=>{var Q;return[s.value&&o.showBackdrop?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["fixed inset-0 bg-black/30 z-40",(Q=o.ui)==null?void 0:Q.backdrop]),onClick:w[0]||(w[0]=L=>o.closeOnBackdropClick&&Z())},null,2)):e.createCommentVNode("",!0)]}),_:1}),e.createVNode(e.Transition,{name:o.position==="left"?"rai-slide-right":"rai-slide-left"},{default:e.withCtx(()=>{var Q,L,Y,re,oe,pe;return[s.value?(e.openBlock(),e.createElementBlock("aside",{key:0,class:e.normalizeClass(["fixed top-0 bottom-0 z-50 flex-shrink-0 h-full border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-2xl will-change-transform",[o.position==="left"?"left-0 border-r":"right-0 border-l",(Q=o.ui)==null?void 0:Q.drawer]]),style:e.normalizeStyle({width:f.value?o.fullscreenWidth:o.width})},[e.createElementVNode("div",{class:e.normalizeClass(["h-full flex flex-col relative bg-white dark:bg-gray-900",(L=o.ui)==null?void 0:L.panel])},[e.renderSlot(B.$slots,"header",e.normalizeProps(e.guardReactiveProps(T.value)),()=>{var K,se,me,be,we,Ee;return[e.createElementVNode("div",{class:e.normalizeClass(["flex items-center justify-between px-4 sm:px-6 pt-4 border-b border-gray-200 dark:border-gray-700 pb-4",(K=o.ui)==null?void 0:K.header])},[e.createElementVNode("div",Ks,[b.value?(e.openBlock(),e.createElementBlock("div",Qs,[...w[4]||(w[4]=[e.createElementVNode("span",{class:"flex h-2 w-2 rounded-full bg-amber-500 animate-pulse"},null,-1),e.createElementVNode("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Setup Required",-1)])])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o.showNewChatButton&&e.unref(i).chatHistory.length>0?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:e.normalizeClass(["inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-400 transition-all duration-200 shadow-sm",(se=o.ui)==null?void 0:se.newChatButton]),onClick:de},[w[3]||(w[3]=e.createElementVNode("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(a("newChat")),1)],2)):(e.openBlock(),e.createElementBlock("span",Zs,e.toDisplayString(a("keyboardShortcutHint")),1))],64))]),o.showQuota&&!b.value?(e.openBlock(),e.createElementBlock("div",Ys,[e.renderSlot(B.$slots,"quota",{quota:e.unref(i).quota},()=>{var Ve,Oe;return[e.unref(i).quota.remaining>0?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["text-xs text-green-600 dark:text-green-400",(Ve=o.ui)==null?void 0:Ve.quotaDisplay])},e.toDisplayString(a("quotaRemaining",{count:e.unref(i).quota.remaining})),3)):e.unref(i).quota.remaining===0?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(["text-xs text-red-600 dark:text-red-400",(Oe=o.ui)==null?void 0:Oe.quotaDisplay])},e.toDisplayString(a("noQuota")),3)):e.createCommentVNode("",!0)]},!0)])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["flex items-center gap-1",(me=o.ui)==null?void 0:me.headerActions])},[o.showCloseButton?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:e.normalizeClass(["p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",(be=o.ui)==null?void 0:be.headerActionButton]),title:a("close"),onClick:ee},[...w[5]||(w[5]=[e.createElementVNode("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],10,Xs)):e.createCommentVNode("",!0),o.showMinimizeButton?(e.openBlock(),e.createElementBlock("button",{key:1,type:"button",class:e.normalizeClass(["p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",(we=o.ui)==null?void 0:we.headerActionButton]),title:a("minimize"),onClick:Z},[...w[6]||(w[6]=[e.createElementVNode("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 12h14"})],-1)])],10,Js)):e.createCommentVNode("",!0),o.showFullscreenToggle?(e.openBlock(),e.createElementBlock("button",{key:2,type:"button",class:e.normalizeClass(["p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",(Ee=o.ui)==null?void 0:Ee.headerActionButton]),title:f.value?a("exitFullscreen"):a("fullscreen"),onClick:W},[f.value?(e.openBlock(),e.createElementBlock("svg",na,[...w[8]||(w[8]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",ta,[...w[7]||(w[7]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])]))],10,ea)):e.createCommentVNode("",!0)],2)],2)]},!0),e.createElementVNode("div",{class:e.normalizeClass(["h-full flex flex-col mx-auto w-full overflow-hidden",[{"max-w-5xl":f.value},(Y=o.ui)==null?void 0:Y.body]])},[b.value?(e.openBlock(),e.createElementBlock("div",ra,[e.renderSlot(B.$slots,"setup",{},()=>[w[12]||(w[12]=e.createElementVNode("div",{class:"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center mb-5"},[e.createElementVNode("svg",{class:"w-7 h-7 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z"})])],-1)),w[13]||(w[13]=e.createElementVNode("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-1"}," Almost there! ",-1)),w[14]||(w[14]=e.createElementVNode("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-6 max-w-sm text-center"}," Configure the plugin in your app entry file to start using AI. ",-1)),e.createElementVNode("div",oa,[e.createElementVNode("div",sa,[e.createElementVNode("div",aa,[w[9]||(w[9]=e.createElementVNode("span",{class:"text-xs text-gray-400"},"main.ts",-1)),e.createElementVNode("button",{type:"button",class:"text-xs text-gray-400 hover:text-white transition-colors",onClick:E},e.toDisplayString(k.value?"âœ“ Copied":"Copy"),1)]),w[10]||(w[10]=e.createElementVNode("pre",{class:"text-xs text-gray-100 p-4 overflow-x-auto leading-relaxed"},[e.createElementVNode("code",{class:"language-typescript"},[e.createElementVNode("span",{class:"text-purple-400"},"import"),e.createTextVNode(" { RestifyAiPlugin } "),e.createElementVNode("span",{class:"text-purple-400"},"from"),e.createTextVNode(),e.createElementVNode("span",{class:"text-green-400"},"'@doderasoftware/restify-ai'"),e.createTextVNode(`

app.`),e.createElementVNode("span",{class:"text-yellow-300"},"use"),e.createTextVNode(`(RestifyAiPlugin, {
  `),e.createElementVNode("span",{class:"text-blue-300"},"endpoints"),e.createTextVNode(`: {
    `),e.createElementVNode("span",{class:"text-blue-300"},"ask"),e.createTextVNode(": "),e.createElementVNode("span",{class:"text-green-400"},"'/api/ai/ask'"),e.createTextVNode(`,
    `),e.createElementVNode("span",{class:"text-blue-300"},"quota"),e.createTextVNode(": "),e.createElementVNode("span",{class:"text-green-400"},"'/api/ai/quota'"),e.createTextVNode(", "),e.createElementVNode("span",{class:"text-gray-500"},"// optional"),e.createTextVNode(`
  },
  `),e.createElementVNode("span",{class:"text-blue-300"},"getAuthToken"),e.createTextVNode(": () => "),e.createElementVNode("span",{class:"text-yellow-300"},"getToken"),e.createTextVNode(`(),
})`)])],-1))]),w[11]||(w[11]=e.createElementVNode("p",{class:"text-xs text-gray-400 dark:text-gray-500 mt-4 text-center"},[e.createTextVNode(" Need help? Check the "),e.createElementVNode("a",{href:"https://github.com/doderasoftware/restify-ai",target:"_blank",class:"text-primary hover:underline"},"documentation")],-1))])],!0)])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.unref(i).chatHistory.length===0?(e.openBlock(),e.createElementBlock("div",ia,[e.renderSlot(B.$slots,"empty-state",{suggestions:_.value,onClick:G},()=>[e.createVNode(sr,{onItemClick:G})],!0)])):(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"chatContainer",ref:p,class:"flex-1 overflow-y-auto py-6 pb-24"},[e.createElementVNode("div",la,[e.createElementVNode("div",ca,[e.createElementVNode("div",ua,[w[15]||(w[15]=e.createElementVNode("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(a("title")||e.unref(te)("aiName")),1)])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i).chatHistory,(K,se)=>e.renderSlot(B.$slots,"message",{key:K.id||se,message:K,isUser:K.role==="user",isLoading:K.loading,isStreaming:K.streaming},()=>[e.createVNode(nr,{message:K,"loading-text":u.value,onCopy:ze},null,8,["message","loading-text"])],!0)),128)),e.unref(i).quota.remaining===0?(e.openBlock(),e.createElementBlock("div",da,[e.createElementVNode("button",{type:"button",class:"inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-all shadow-sm",onClick:Ie},[w[16]||(w[16]=e.createElementVNode("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(e.unref(te)("contactSupport")),1)])])):e.createCommentVNode("",!0),e.unref(i).error.message?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["flex items-center gap-2 text-sm text-red-600 dark:text-red-400 px-2 py-1 pb-6",(re=o.ui)==null?void 0:re.errorContainer])},[e.createElementVNode("span",{class:e.normalizeClass((oe=o.ui)==null?void 0:oe.errorMessage)},e.toDisplayString(e.unref(i).error.message),3),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["inline-flex items-center gap-1 text-red-700 dark:text-red-300 hover:text-red-800 dark:hover:text-red-200 font-medium",(pe=o.ui)==null?void 0:pe.retryButton]),title:a("retry"),onClick:Ge},[...w[17]||(w[17]=[e.createElementVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],10,pa)],2)):e.createCommentVNode("",!0)])],512)),w[18]||(w[18]=e.createElementVNode("div",{id:"rai-chat-bottom",class:"h-8"},null,-1)),e.renderSlot(B.$slots,"input",e.normalizeProps(e.guardReactiveProps(S.value)),()=>{var K,se;return[e.createVNode(or,{modelValue:c.value,"onUpdate:modelValue":w[1]||(w[1]=me=>c.value=me),sending:e.unref(i).sending,placeholder:((K=n.texts)==null?void 0:K.placeholder)||e.unref(te)("inputPlaceholder"),"support-placeholder":((se=n.texts)==null?void 0:se.supportPlaceholder)||e.unref(te)("supportPlaceholder"),suggestions:_.value,"has-history":e.unref(i).chatHistory.length>0,"support-request-mode":e.unref(i).supportRequestMode,"show-support-mode-toggle":x.value,onSubmit:We,onCancel:e.unref(i).cancelRequest,onSuggestionSelect:O,onToggleSupportMode:q},{"context-link":e.withCtx(()=>[e.renderSlot(B.$slots,"context-link",{},void 0,!0)]),_:3},8,["modelValue","sending","placeholder","support-placeholder","suggestions","has-history","support-request-mode","show-support-mode-toggle","onCancel"])]},!0)],64))],2)],2),e.createVNode(e.Transition,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:e.withCtx(()=>{var K,se,me;return[y.value?(e.openBlock(),e.createElementBlock("div",fa,[e.createElementVNode("div",{class:e.normalizeClass(["bg-white dark:bg-gray-800 rounded-xl p-6 m-4 max-w-sm w-full shadow-xl",(K=o.ui)==null?void 0:K.closeConfirmModal])},[e.createElementVNode("h3",ha,e.toDisplayString(a("closeConfirmTitle")),1),e.createElementVNode("p",ma,e.toDisplayString(a("closeConfirmMessage")),1),e.createElementVNode("div",ga,[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",(se=o.ui)==null?void 0:se.cancelButton]),onClick:w[2]||(w[2]=be=>y.value=!1)},e.toDisplayString(a("cancel")),3),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors",(me=o.ui)==null?void 0:me.closeConfirmButton]),onClick:xe},e.toDisplayString(a("confirmClose")),3)])],2)])):e.createCommentVNode("",!0)]}),_:1})],6)):e.createCommentVNode("",!0)]}),_:3},8,["name"])]))}}),[["__scopeId","data-v-3d44dd49"]]),ar={install(o,t){if(!t.endpoints||!t.getAuthToken){console.warn("[@doderasoftware/restify-ai] Plugin requires endpoints and getAuthToken options.");return}const n={endpoints:t.endpoints,baseUrl:t.baseUrl,getAuthToken:t.getAuthToken,getCustomHeaders:t.getCustomHeaders,buildRequest:t.buildRequest,parseStreamContent:t.parseStreamContent,requestInterceptor:t.requestInterceptor,responseInterceptor:t.responseInterceptor,retry:t.retry,translate:t.translate,can:t.can,labels:{...Mt,...t.labels},mentionProviders:t.mentionProviders,suggestionProviders:t.suggestionProviders,defaultSuggestions:t.defaultSuggestions,theme:t.theme,chatHistoryLimit:t.chatHistoryLimit,maxAttachments:t.maxAttachments,maxFileSize:t.maxFileSize,acceptedFileTypes:t.acceptedFileTypes,chatHistoryKey:t.chatHistoryKey,drawerStateKey:t.drawerStateKey,keyboardShortcut:t.keyboardShortcut,enableSupportMode:t.enableSupportMode,assistantAvatar:t.assistantAvatar,userAvatar:t.userAvatar,onQuotaFetched:t.onQuotaFetched,onError:t.onError,onMessageSent:t.onMessageSent,onResponseReceived:t.onResponseReceived,onDrawerToggle:t.onDrawerToggle,onNewChat:t.onNewChat,onStreamStart:t.onStreamStart,onStreamEnd:t.onStreamEnd,onStreamChunk:t.onStreamChunk,beforeSend:t.beforeSend,afterResponse:t.afterResponse,onFileUploadStart:t.onFileUploadStart,onFileUploadProgress:t.onFileUploadProgress,onFileUploadComplete:t.onFileUploadComplete,onFileUploadError:t.onFileUploadError};an(n),o.provide("restify-ai-config",n)}};N.AiAvatar=Xn,N.AiChatDrawer=ka,N.AiEmptyState=sr,N.ChatInput=or,N.ChatMessage=nr,N.ChatMessageActions=er,N.ChatRoles=Bt,N.MentionList=Jn,N.RestifyAiPlugin=ar,N.UserAvatar=Yo,N.default=ar,N.defaultLabels=Mt,N.formatMentionsForApi=xn,N.getConfigValue=Fe,N.getLabel=te,N.getRestifyAiConfig=j,N.getRestifyAiConfigOrThrow=wr,N.getSuggestionsForPath=Qn,N.groupMentionsByType=bn,N.isConfigured=Rt,N.registerSuggestionProvider=Wo,N.setRestifyAiConfig=an,N.useAiContext=Jt,N.useAiDrawerShortcut=Qo,N.useAiSuggestions=en,N.useChatErrorHandling=Uo,N.useChatMarkdown=Kn,N.useChatScroll=Ho,N.useKeyboardShortcut=Yn,N.useMentionParsing=Pr,N.usePageAiContext=Go,N.useRestifyAiStore=Ue,Object.defineProperties(N,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
